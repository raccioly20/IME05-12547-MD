{
  "hash": "9eec6f7aaa3bd70a386cc25718a54d1a",
  "result": {
    "markdown": "---\ntitle: \"Carregando dados, Manipulando e Visualizando\"\nauthor: \"Ricardo Accioly\"\ndate: ' 2023-04-01 '\noutput:\n html_document:\n    toc: yes\n    code_download: yes\n---\n\n\n\n\n## Entrada de dados no R\n\n## Lendo dados de arquivos csv\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr)\nurl <- \"https://www.gov.br/anp/pt-br/centrais-de-conteudo/dados-abertos/arquivos-acervo-de-dados-tecnicos/tabela-pocos.csv\"\n## O read_delim permite que seja definido o tipo de delimitador dos dados\npocos <- read_delim(url, delim = \";\", locale= locale(decimal_mark = \",\"), col_names = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 30410 Columns: 60\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr (51): POCO, CADASTRO, OPERADOR, POCO_OPERADOR, ESTADO, BACIA, BLOCO, SIG...\ndbl  (8): LATITUDE_BASE_DD, LONGITUDE_BASE_DD, PROFUNDIDADE_VERTICAL_M, PROF...\nlgl  (1): UNIDADE_ESTRATIGRAFICA\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nhead(pocos)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 60\n  POCO        CADASTRO OPERADOR POCO_OPERADOR ESTADO BACIA BLOCO SIG_CAMPO CAMPO\n  <chr>       <chr>    <chr>    <chr>         <chr>  <chr> <chr> <chr>     <chr>\n1 7-GC-12-RN  7210002… Níon En… GALO DE CAMP… RN     Poti… <NA>  \"GC   \"   GALO…\n2 7-GC-13-RN  7210002… Níon En… GALO DE CAMP… RN     Poti… <NA>  \"GC   \"   GALO…\n3 7-GC-8-RN   7210002… Níon En… GALO DE CAMP… RN     Poti… BTP1… \"GC   \"   GALO…\n4 7-ROL-1-RN  7210002… Níon En… ROLINHA 01    RN     Poti… <NA>  \"ROL  \"   ROLI…\n5 3-BRSA-123… 7210002… Petrobr… 3ARG805RN     RN     Poti… <NA>  \"ARG  \"   ALTO…\n6 7-ET-1523D… 7210002… Petrobr… 7ET1523DRN    RN     Poti… <NA>  \"ET   \"   ESTR…\n# ℹ 51 more variables: TERRA_MAR <chr>, POCO_POS_ANP <chr>, TIPO <chr>,\n#   CATEGORIA <chr>, RECLASSIFICACAO <chr>, SITUACAO <chr>, INICIO <chr>,\n#   TERMINO <chr>, CONCLUSAO <chr>, TITULARIDADE <chr>, LATITUDE_BASE_4C <chr>,\n#   LONGITUDE_BASE_4C <chr>, LATITUDE_BASE_DD <dbl>, LONGITUDE_BASE_DD <dbl>,\n#   DATUM_HORIZONTAL <chr>, TIPO_DE_COORDENADA_DE_BASE <chr>, DIRECAO <chr>,\n#   PROFUNDIDADE_VERTICAL_M <dbl>, PROFUNDIDADE_SONDADOR_M <dbl>,\n#   PROFUNDIDADE_MEDIDA_M <dbl>, REFERENCIA_DE_PROFUNDIDADE <chr>, …\n```\n:::\n:::\n\n\n## Bibliotecas\n\nVamos carregar as bibliotecas que serão usadas na manipulação e visualização de dados.\n\nO pacote tidyverse carrega diversos pacotes muito uteis na manipulação e visualização de dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"tidyverse\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.1     ✔ purrr     1.0.1\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n:::\n\n\nVamos primeiro conhecer o que tem na base de dados pocos. A base de dados possui 30410 linhas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(pocos)  # Tipo de base de dados\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"spec_tbl_df\" \"tbl_df\"      \"tbl\"         \"data.frame\" \n```\n:::\n\n```{.r .cell-code}\nsummary(pocos) # Sumario da base de dados\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     POCO             CADASTRO           OPERADOR         POCO_OPERADOR     \n Length:30410       Length:30410       Length:30410       Length:30410      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n    ESTADO             BACIA              BLOCO            SIG_CAMPO        \n Length:30410       Length:30410       Length:30410       Length:30410      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n    CAMPO            TERRA_MAR         POCO_POS_ANP           TIPO          \n Length:30410       Length:30410       Length:30410       Length:30410      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n  CATEGORIA         RECLASSIFICACAO      SITUACAO            INICIO         \n Length:30410       Length:30410       Length:30410       Length:30410      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n   TERMINO           CONCLUSAO         TITULARIDADE       LATITUDE_BASE_4C  \n Length:30410       Length:30410       Length:30410       Length:30410      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n LONGITUDE_BASE_4C  LATITUDE_BASE_DD  LONGITUDE_BASE_DD DATUM_HORIZONTAL  \n Length:30410       Min.   :-32.927   Min.   :-73.38    Length:30410      \n Class :character   1st Qu.:-12.694   1st Qu.:-39.65    Class :character  \n Mode  :character   Median :-10.710   Median :-37.83    Mode  :character  \n                    Mean   :-11.490   Mean   :-38.84                      \n                    3rd Qu.: -5.328   3rd Qu.:-36.98                      \n                    Max.   :  4.528   Max.   :-34.83                      \n                                                                          \n TIPO_DE_COORDENADA_DE_BASE   DIRECAO          PROFUNDIDADE_VERTICAL_M\n Length:30410               Length:30410       Min.   :-59053.0       \n Class :character           Class :character   1st Qu.:  -712.6       \n Mode  :character           Mode  :character   Median :     0.0       \n                                               Mean   :  -240.9       \n                                               3rd Qu.:     0.0       \n                                               Max.   :528084.0       \n                                               NA's   :18906          \n PROFUNDIDADE_SONDADOR_M PROFUNDIDADE_MEDIDA_M REFERENCIA_DE_PROFUNDIDADE\n Min.   :    0.0         Min.   :    0.0       Length:30410              \n 1st Qu.:  481.6         1st Qu.:  290.6       Class :character          \n Median :  992.0         Median :  840.8       Mode  :character          \n Mean   : 1498.8         Mean   : 1527.3                                 \n 3rd Qu.: 2226.0         3rd Qu.: 2521.5                                 \n Max.   :29170.0         Max.   :29185.0                                 \n NA's   :948             NA's   :17385                                   \n MESA_ROTATIVA     COTA_ALTIMETRICA_M LAMINA_D_AGUA_M  DATUM_VERTICAL    \n Min.   :   0.00   Min.   :   0.00    Min.   :   0.0   Length:30410      \n 1st Qu.:  19.00   1st Qu.:   0.00    1st Qu.:   0.0   Class :character  \n Median :  32.40   Median :  11.00    Median :   0.0   Mode  :character  \n Mean   :  57.16   Mean   :  37.78    Mean   : 277.1                     \n 3rd Qu.:  75.60   3rd Qu.:  55.73    3rd Qu.: 114.0                     \n Max.   :1600.00   Max.   :6672.00    Max.   :3094.0                     \n                   NA's   :16850      NA's   :14390                      \n UNIDADE_ESTRATIGRAFICA GEOLOGIA_GRUPO_FINAL GEOLOGIA_FORMACAO_FINAL\n Mode:logical           Length:30410         Length:30410           \n NA's:30410             Class :character     Class :character       \n                        Mode  :character     Mode  :character       \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n GEOLOGIA_MEMBRO_FINAL     CDPE               AGP                 PC           \n Length:30410          Length:30410       Length:30410       Length:30410      \n Class :character      Class :character   Class :character   Class :character  \n Mode  :character      Mode  :character   Mode  :character   Mode  :character  \n                                                                               \n                                                                               \n                                                                               \n                                                                               \n     PAG            PERFIS_CONVENCIONAIS DURANTE_PERFURACAO PERFIS_DIGITAIS   \n Length:30410       Length:30410         Length:30410       Length:30410      \n Class :character   Class :character     Class :character   Class :character  \n Mode  :character   Mode  :character     Mode  :character   Mode  :character  \n                                                                              \n                                                                              \n                                                                              \n                                                                              \n PERFIS_PROCESSADOS PERFIS_ESPECIAIS   AMOSTRA_LATERAL      SISMICA         \n Length:30410       Length:30410       Length:30410       Length:30410      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n TABELA_TEMPO_PROFUNDIDADE DADOS_DIRECIONAIS  TESTE_A_CABO      \n Length:30410              Length:30410       Length:30410      \n Class :character          Class :character   Class :character  \n Mode  :character          Mode  :character   Mode  :character  \n                                                                \n                                                                \n                                                                \n                                                                \n TESTE_DE_FORMACAO   CANHONEIO          TESTEMUNHO         GEOQUIMICA       \n Length:30410       Length:30410       Length:30410       Length:30410      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n  SIG_SONDA          NOM_SONDA         ATINGIU_PRESAL     DHA_ATUALIZACAO   \n Length:30410       Length:30410       Length:30410       Length:30410      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n```\n:::\n:::\n\n\n## Dados de poços\n\nOs dados da tabela poços tem 60 colunas.\n\nVamos inicialmente selecionar algumas colunas para podermos trabalhar com os dados.\n\n**As colunas que vamos trabalhar são:**\n\n1)  POCO\n2)  OPERADOR\n3)  ESTADO\n4)  BACIA\n5)  BLOCO\n6)  CAMPO\n7)  TERRA_MAR\n8)  CATEGORIA\n9)  SITUACAO\n10) INICIO\n11) TERMINO\n12) PROFUNDIDADE_MEDIDA_M\n\nPara selecionar colunas usamos a função `select`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Vamos selecionar as colunas listadas acima\npocos_01 <- pocos %>% select(POCO,OPERADOR,ESTADO,BACIA,BLOCO, CAMPO,TERRA_MAR,CATEGORIA,SITUACAO, INICIO, TERMINO, PROFUNDIDADE_MEDIDA_M)\nhead(pocos_01)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 12\n  POCO     OPERADOR ESTADO BACIA BLOCO CAMPO TERRA_MAR CATEGORIA SITUACAO INICIO\n  <chr>    <chr>    <chr>  <chr> <chr> <chr> <chr>     <chr>     <chr>    <chr> \n1 7-GC-12… Níon En… RN     Poti… <NA>  GALO… T         Desenvol… PRODUZI… 28/02…\n2 7-GC-13… Níon En… RN     Poti… <NA>  GALO… T         Desenvol… PRODUZI… 05/03…\n3 7-GC-8-… Níon En… RN     Poti… BTP1… GALO… T         Desenvol… PRODUZI… 31/03…\n4 7-ROL-1… Níon En… RN     Poti… <NA>  ROLI… T         Desenvol… PRODUZI… 08/02…\n5 3-BRSA-… Petrobr… RN     Poti… <NA>  ALTO… T         Extensão  ARRASADO 13/03…\n6 7-ET-15… Petrobr… RN     Poti… <NA>  ESTR… T         Desenvol… PRODUZI… 04/04…\n# ℹ 2 more variables: TERMINO <chr>, PROFUNDIDADE_MEDIDA_M <dbl>\n```\n:::\n:::\n\n\n## Manipulação de dados\n\nVamos eliminar as linhas de dados que apresenta dados ausentes \"NA\" nas colunas TERMINO e PROFUNDIDADE_MEDIDA_M.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(is.na(pocos_01))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 30013\n```\n:::\n\n```{.r .cell-code}\nsum(is.na(pocos_01$INICIO))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n\n```{.r .cell-code}\nsum(is.na(pocos_01$TERMINO))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1839\n```\n:::\n\n```{.r .cell-code}\nsum(is.na(pocos_01$PROFUNDIDADE_MEDIDA_M))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 17385\n```\n:::\n\n```{.r .cell-code}\npocos_01 <- pocos_01 %>% drop_na(any_of(c(\"TERMINO\",\n                                          \"PROFUNDIDADE_MEDIDA_M\")))\n# melhorando a visualização dos dados\nknitr::kable(\n  head(pocos_01, 10), booktabs = TRUE,\n  caption = 'Uma tabela mais elegante com as 10 primeras linhas de pocos_01.')\n```\n\n::: {.cell-output-display}\nTable: Uma tabela mais elegante com as 10 primeras linhas de pocos_01.\n\n|POCO            |OPERADOR       |ESTADO |BACIA     |BLOCO    |CAMPO             |TERRA_MAR |CATEGORIA       |SITUACAO   |INICIO           |TERMINO          | PROFUNDIDADE_MEDIDA_M|\n|:---------------|:--------------|:------|:---------|:--------|:-----------------|:---------|:---------------|:----------|:----------------|:----------------|---------------------:|\n|7-GC-12-RN      |Níon Energia   |RN     |Potiguar  |NA       |GALO DE CAMPINA   |T         |Desenvolvimento |PRODUZINDO |28/02/2014 00:00 |02/03/2014 00:00 |                 758.0|\n|7-GC-13-RN      |Níon Energia   |RN     |Potiguar  |NA       |GALO DE CAMPINA   |T         |Desenvolvimento |PRODUZINDO |05/03/2014 00:00 |08/03/2014 00:00 |                 777.0|\n|7-GC-8-RN       |Níon Energia   |RN     |Potiguar  |BTP10B   |GALO DE CAMPINA   |T         |Desenvolvimento |PRODUZINDO |31/03/2014 00:00 |03/04/2014 00:00 |                 790.0|\n|7-ROL-1-RN      |Níon Energia   |RN     |Potiguar  |NA       |ROLINHA           |T         |Desenvolvimento |PRODUZINDO |08/02/2014 00:00 |10/02/2014 00:00 |                 786.0|\n|3-BRSA-1232-RN  |Petrobras      |RN     |Potiguar  |NA       |ALTO DO RODRIGUES |T         |Extensão        |ARRASADO   |13/03/2014 00:00 |19/03/2014 00:00 |                 488.2|\n|7-ET-1523D-RN   |Petrobras      |RN     |Potiguar  |NA       |ESTREITO          |T         |Desenvolvimento |PRODUZINDO |04/04/2015 00:00 |06/04/2015 00:00 |                 293.0|\n|7-ET-1522-RN    |Petrobras      |RN     |Potiguar  |NA       |ESTREITO          |T         |Desenvolvimento |FECHADO    |14/04/2015 00:00 |15/04/2015 00:00 |                 264.0|\n|7-ET-1518-RN    |Petrobras      |RN     |Potiguar  |NA       |ESTREITO          |T         |Desenvolvimento |PRODUZINDO |09/04/2015 00:00 |11/04/2015 00:00 |                 260.0|\n|7-PIR-276D-AL   |Origem Alagoas |AL     |Alagoas   |NA       |PILAR             |T         |Desenvolvimento |PRODUZINDO |06/03/2015 00:00 |27/03/2015 00:00 |                2423.0|\n|1-BRSA-1300D-BA |Petrobras      |BA     |Recôncavo |REC-T-70 |NA                |T         |Pioneiro        |ARRASADO   |21/03/2015 00:00 |29/04/2015 00:00 |                3051.0|\n:::\n\n```{.r .cell-code}\nsum(is.na(pocos_01))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4574\n```\n:::\n:::\n\n\n## Corrigindo tipo de dados\n\nAs colunas INICIO e TERMINO são datas, mas foram lidas como caracter, vamos corrigir isto!\n\nPara trabalhar com datas vamos usar o pacote `lubridate`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lubridate)\npocos_01$INICIO <- dmy_hm(pocos_01$INICIO, locale = Sys.getlocale(\"LC_TIME\"))\npocos_01$TERMINO <- dmy_hm(pocos_01$TERMINO, locale = Sys.getlocale(\"LC_TIME\"))\n```\n:::\n\n\n## Filtrando dados\n\nVamos analisar os poços de uma detreminada região, para isto podemos fltrar os poços de um bloco. Vamos filtrar somente os poços do CAMPO PEREGRINO usando a função `filter`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npocos_02 <- pocos_01 %>% filter(CAMPO==\"PEREGRINO\") ##  \nsummary(pocos_02)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     POCO             OPERADOR            ESTADO             BACIA          \n Length:104         Length:104         Length:104         Length:104        \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n    BLOCO              CAMPO            TERRA_MAR          CATEGORIA        \n Length:104         Length:104         Length:104         Length:104        \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n   SITUACAO             INICIO                      \n Length:104         Min.   :1994-07-07 00:00:00.00  \n Class :character   1st Qu.:2012-02-01 18:00:00.00  \n Mode  :character   Median :2013-12-08 12:00:00.00  \n                    Mean   :2014-08-13 13:23:04.61  \n                    3rd Qu.:2017-03-11 12:00:00.00  \n                    Max.   :2022-10-17 00:00:00.00  \n    TERMINO                       PROFUNDIDADE_MEDIDA_M\n Min.   :1994-08-17 00:00:00.00   Min.   :   0         \n 1st Qu.:2012-03-06 12:00:00.00   1st Qu.:4437         \n Median :2014-01-17 00:00:00.00   Median :4877         \n Mean   :2014-09-16 19:36:55.38   Mean   :5009         \n 3rd Qu.:2017-04-14 12:00:00.00   3rd Qu.:6138         \n Max.   :2022-11-03 00:00:00.00   Max.   :8613         \n```\n:::\n\n```{.r .cell-code}\nknitr::kable(\n  head(pocos_02, 10), booktabs = TRUE,\n  caption = 'Uma tabela mais elegante com as 10 primeras linhas de pocos_02.')\n```\n\n::: {.cell-output-display}\nTable: Uma tabela mais elegante com as 10 primeras linhas de pocos_02.\n\n|POCO           |OPERADOR       |ESTADO |BACIA  |BLOCO  |CAMPO     |TERRA_MAR |CATEGORIA       |SITUACAO                                     |INICIO     |TERMINO    | PROFUNDIDADE_MEDIDA_M|\n|:--------------|:--------------|:------|:------|:------|:---------|:---------|:---------------|:--------------------------------------------|:----------|:----------|---------------------:|\n|7-PRG-46H-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |FECHADO                                      |2015-03-06 |2015-05-07 |               7432.00|\n|8-PRG-39D-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Injeção         |INJETANDO                                    |2014-07-18 |2014-09-25 |               7075.63|\n|3-PRG-1DA-RJS  |Equinor Brasil |RJ     |Campos |BM-C-7 |PEREGRINO |M         |Extensão        |ABANDONADO PERMANENTEMENTE                   |2007-06-04 |2007-06-28 |               2655.00|\n|3-PRG-1-RJS    |Equinor Brasil |RJ     |Campos |BM-C-7 |PEREGRINO |M         |Extensão        |ABANDONADO PERMANENTEMENTE                   |2007-05-05 |2007-06-03 |               2432.00|\n|9-PRG-75i-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Especial        |ABANDONADO TEMPORARIAMENTE SEM MONITORAMENTO |2022-06-11 |2022-06-21 |               1513.00|\n|7-PRG-76H-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |ABANDONADO TEMPORARIAMENTE SEM MONITORAMENTO |2022-07-05 |2022-07-13 |                688.00|\n|7-PRG-79HP-RJS |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |PRODUZINDO                                   |2022-08-21 |2022-08-24 |               4708.00|\n|7-PRG-80HP-RJS |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |PRODUZINDO                                   |2022-10-17 |2022-11-03 |               5907.00|\n|9-PRG-78H-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Especial        |ABANDONADO TEMPORARIAMENTE SEM MONITORAMENTO |2022-09-13 |2022-09-28 |               4958.00|\n|7-PRG-77HP-RJS |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |ABANDONADO TEMPORARIAMENTE SEM MONITORAMENTO |2022-07-16 |2022-08-20 |               3219.00|\n:::\n:::\n\n\n### Avaliando os dados\n\nOs poços possuem diversas categorias, vamos ver que categorias existem nestes poços do bloco BES-100.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(pocos_02$CATEGORIA)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Desenvolvimento\" \"Injeção\"         \"Extensão\"        \"Especial\"       \n[5] \"Pioneiro\"       \n```\n:::\n:::\n\n\n### Filtrando poços de desenvolvimento\n\n\n::: {.cell}\n\n```{.r .cell-code}\npocos_03 <- pocos_02 %>% filter(CATEGORIA==\"Desenvolvimento\") ##  \nsummary(pocos_03)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     POCO             OPERADOR            ESTADO             BACIA          \n Length:81          Length:81          Length:81          Length:81         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n    BLOCO              CAMPO            TERRA_MAR          CATEGORIA        \n Length:81          Length:81          Length:81          Length:81         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n   SITUACAO             INICIO                      \n Length:81          Min.   :2010-11-10 00:00:00.00  \n Class :character   1st Qu.:2012-04-22 00:00:00.00  \n Mode  :character   Median :2014-10-10 00:00:00.00  \n                    Mean   :2015-03-12 07:24:26.67  \n                    3rd Qu.:2017-05-26 00:00:00.00  \n                    Max.   :2022-10-17 00:00:00.00  \n    TERMINO                       PROFUNDIDADE_MEDIDA_M\n Min.   :2010-11-11 00:00:00.00   Min.   : 269         \n 1st Qu.:2012-05-12 00:00:00.00   1st Qu.:4492         \n Median :2014-11-07 00:00:00.00   Median :5034         \n Mean   :2015-04-16 03:15:33.32   Mean   :5245         \n 3rd Qu.:2017-06-04 00:00:00.00   3rd Qu.:6383         \n Max.   :2022-11-03 00:00:00.00   Max.   :8613         \n```\n:::\n\n```{.r .cell-code}\nknitr::kable(\n  head(pocos_03, 10), booktabs = TRUE,\n  caption = 'Uma tabela mais elegante com as 10 primeras linhas de pocos_03.')\n```\n\n::: {.cell-output-display}\nTable: Uma tabela mais elegante com as 10 primeras linhas de pocos_03.\n\n|POCO           |OPERADOR       |ESTADO |BACIA  |BLOCO  |CAMPO     |TERRA_MAR |CATEGORIA       |SITUACAO                                     |INICIO     |TERMINO    | PROFUNDIDADE_MEDIDA_M|\n|:--------------|:--------------|:------|:------|:------|:---------|:---------|:---------------|:--------------------------------------------|:----------|:----------|---------------------:|\n|7-PRG-46H-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |FECHADO                                      |2015-03-06 |2015-05-07 |                7432.0|\n|7-PRG-76H-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |ABANDONADO TEMPORARIAMENTE SEM MONITORAMENTO |2022-07-05 |2022-07-13 |                 688.0|\n|7-PRG-79HP-RJS |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |PRODUZINDO                                   |2022-08-21 |2022-08-24 |                4708.0|\n|7-PRG-80HP-RJS |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |PRODUZINDO                                   |2022-10-17 |2022-11-03 |                5907.0|\n|7-PRG-77HP-RJS |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |ABANDONADO TEMPORARIAMENTE SEM MONITORAMENTO |2022-07-16 |2022-08-20 |                3219.0|\n|7-PRG-11H-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |PRODUZINDO                                   |2011-09-11 |2011-10-18 |                6100.4|\n|7-PRG-70H-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |PRODUZINDO                                   |2020-02-12 |2021-10-02 |                8326.0|\n|7-PRG-66HP-RJS |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |PRODUZINDO                                   |2019-02-11 |2019-03-07 |                6529.0|\n|7-PRG-2HA-RJS  |Equinor Brasil |RJ     |Campos |BM-C-7 |PEREGRINO |M         |Desenvolvimento |ABANDONADO PERMANENTEMENTE                   |2010-11-17 |2010-12-10 |                3995.0|\n|7-PRG-2HB-RJS  |Equinor Brasil |RJ     |Campos |BM-C-7 |PEREGRINO |M         |Desenvolvimento |FECHADO                                      |2011-01-16 |2011-02-03 |                4676.0|\n:::\n:::\n\n\n## Criando uma coluna com mutate\n\nVamos criar uma coluna que nos dará a duração da perfuração dos poços.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npocos_03$INICIO[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2015-03-06 UTC\"\n```\n:::\n\n```{.r .cell-code}\npocos_03$TERMINO[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2015-05-07 UTC\"\n```\n:::\n\n```{.r .cell-code}\npocos_03$TERMINO[1] - pocos_03$INICIO[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTime difference of 62 days\n```\n:::\n\n```{.r .cell-code}\ndifftime(pocos_03$TERMINO[1], pocos_03$INICIO[1], units = \"days\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTime difference of 62 days\n```\n:::\n\n```{.r .cell-code}\ntempo <- difftime(pocos_03$TERMINO[1], pocos_03$INICIO[1], units = \"days\")\nstr(tempo)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n 'difftime' num 62\n - attr(*, \"units\")= chr \"days\"\n```\n:::\n\n```{.r .cell-code}\n(pocos_03$INICIO[1] %--% pocos_03$TERMINO[1])/ddays(1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 62\n```\n:::\n\n```{.r .cell-code}\npocos_03 <- pocos_03 %>% mutate(TPERF = (INICIO %--% TERMINO)/ddays(1))\nsummary(pocos_03)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     POCO             OPERADOR            ESTADO             BACIA          \n Length:81          Length:81          Length:81          Length:81         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n    BLOCO              CAMPO            TERRA_MAR          CATEGORIA        \n Length:81          Length:81          Length:81          Length:81         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n   SITUACAO             INICIO                      \n Length:81          Min.   :2010-11-10 00:00:00.00  \n Class :character   1st Qu.:2012-04-22 00:00:00.00  \n Mode  :character   Median :2014-10-10 00:00:00.00  \n                    Mean   :2015-03-12 07:24:26.67  \n                    3rd Qu.:2017-05-26 00:00:00.00  \n                    Max.   :2022-10-17 00:00:00.00  \n    TERMINO                       PROFUNDIDADE_MEDIDA_M     TPERF        \n Min.   :2010-11-11 00:00:00.00   Min.   : 269          Min.   :-347.00  \n 1st Qu.:2012-05-12 00:00:00.00   1st Qu.:4492          1st Qu.:  13.00  \n Median :2014-11-07 00:00:00.00   Median :5034          Median :  24.00  \n Mean   :2015-04-16 03:15:33.32   Mean   :5245          Mean   :  34.83  \n 3rd Qu.:2017-06-04 00:00:00.00   3rd Qu.:6383          3rd Qu.:  37.00  \n Max.   :2022-11-03 00:00:00.00   Max.   :8613          Max.   : 598.00  \n```\n:::\n:::\n\n\n### Eliminando colunas com tempos negativos\n\n\n::: {.cell}\n\n```{.r .cell-code}\npocos_03 <- pocos_03 %>% filter(TPERF > 0) \n```\n:::\n\n\n## Visualizando os dados de PEREGRINO\n\n### Box-Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pocos_03, aes(x=CAMPO, y=TPERF)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](imagens/Aula01/boxplot-1.png){width=960}\n:::\n:::\n\n\nVeja que existem alguns tempos bem elevados que estão representados por pontos no box-plot. Eles podem ser considerados pontos afastados (outliers), que neste caso vamos eliminar.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npocos_04 <- pocos_03 %>% filter(TPERF < 100)\nggplot(pocos_04, aes(x=CAMPO, y=TPERF)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](imagens/Aula01/outliers-1.png){width=960}\n:::\n:::\n\n\n### Histograma\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pocos_04, aes(x=TPERF)) +\n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](imagens/Aula01/histograma-1.png){width=960}\n:::\n:::\n\n\nVeja que desta forma o ggplot usa o seu padrão de 30 faixas de dados, que geralmente não é o mais adequado.\n\nVamos usar uma regra adequada para definição de número de faixas.\n\n### Criando um histograma usando a regra de Sturges\n\nA regra de Sturges indica 7 faixas enquanto que o padrão do ggplot2 é 30.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pocos_04, aes(x = TPERF)) +\n  geom_histogram(bins = round(1+3.322*log10(nrow(pocos_04)),0))\n```\n\n::: {.cell-output-display}\n![](imagens/Aula01/Sturges-1.png){width=960}\n:::\n:::\n\n\nVeja que agora temos um histograma mais suave.\n\n### Gráfico de Dispersão\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pocos_04, aes(x=PROFUNDIDADE_MEDIDA_M, y=TPERF)) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![](imagens/Aula01/dispersao-1.png){width=960}\n:::\n:::\n\n\nPodemos perceber que há uma relação entre o tempo de perfuração e a profundidade do poço.\n\nTambém é possível se perceber que ainda existem dados com comportamentos estranhos. Poços rasos com profundidade muito diferente dos demais, além disso um poço muito profundo com duração muito pequena.\n\nSe fossemos construir um modelo certamente terímos que investigar o porque destes comportamentos.\n\n### Alterando nome das colunas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(pocos_04)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"POCO\"                  \"OPERADOR\"              \"ESTADO\"               \n [4] \"BACIA\"                 \"BLOCO\"                 \"CAMPO\"                \n [7] \"TERRA_MAR\"             \"CATEGORIA\"             \"SITUACAO\"             \n[10] \"INICIO\"                \"TERMINO\"               \"PROFUNDIDADE_MEDIDA_M\"\n[13] \"TPERF\"                \n```\n:::\n\n```{.r .cell-code}\nnames(pocos_04) <- tolower(names(pocos_04))\nnames(pocos_04)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"poco\"                  \"operador\"              \"estado\"               \n [4] \"bacia\"                 \"bloco\"                 \"campo\"                \n [7] \"terra_mar\"             \"categoria\"             \"situacao\"             \n[10] \"inicio\"                \"termino\"               \"profundidade_medida_m\"\n[13] \"tperf\"                \n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}