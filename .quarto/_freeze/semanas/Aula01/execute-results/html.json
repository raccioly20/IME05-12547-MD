{
  "hash": "405408213761a7686a70fd8b96978f5f",
  "result": {
    "markdown": "---\ntitle: \"Carregando dados, Manipulando e Visualizando\"\nauthor: \"Ricardo Accioly\"\ndate: ' 2022-08-12 '\noutput:\n html_document:\n    toc: yes\n    code_download: yes\n---\n\n\n\n\n## Entrada de dados no R\n\n## Lendo dados de arquivos csv\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr)\nurl <- \"https://www.gov.br/anp/pt-br/centrais-de-conteudo/dados-abertos/arquivos-acervo-de-dados-tecnicos/tabela-pocos.csv\"\n## O read_delim permite que seja definido o tipo de delimitador dos dados\npocos <- read_delim(url, delim = \";\", locale= locale(decimal_mark = \",\"), col_names = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 30255 Columns: 60\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr (51): POCO, CADASTRO, OPERADOR, POCO_OPERADOR, ESTADO, BACIA, BLOCO, SIG...\ndbl  (8): LATITUDE_BASE_DD, LONGITUDE_BASE_DD, PROFUNDIDADE_VERTICAL_M, PROF...\nlgl  (1): UNIDADE_ESTRATIGRAFICA\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nhead(pocos)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 60\n  POCO  CADAS…¹ OPERA…² POCO_…³ ESTADO BACIA BLOCO SIG_C…⁴ CAMPO TERRA…⁵ POCO_…⁶\n  <chr> <chr>   <chr>   <chr>   <chr>  <chr> <chr> <chr>   <chr> <chr>   <chr>  \n1 7-PC… 721000… 3R Mac… 7PC  0… RN     Poti… PC    \"PC   \" PORT… T       N      \n2 7-CO… 742810… Petrob… 7CO  0… RJ     Camp… CO    \"CO   \" CORV… M       N      \n3 7-BA… 202400… Petrob… 7BA  0… BA     Recô… BA    \"BA   \" BURA… T       N      \n4 7-ET… 721000… Petrob… 7ET  0… RN     Poti… ET    \"ET   \" ESTR… T       N      \n5 4-FS… 342700… Petrob… 4FSL 0… ES     Espí… FSL   \"FSL  \" FAZE… T       N      \n6 7-CA… 721000… Petrob… 7CAM 0… RN     Poti… CAM   \"CAM  \" CANT… T       N      \n# … with 49 more variables: TIPO <chr>, CATEGORIA <chr>, RECLASSIFICACAO <chr>,\n#   SITUACAO <chr>, INICIO <chr>, TERMINO <chr>, CONCLUSAO <chr>,\n#   TITULARIDADE <chr>, LATITUDE_BASE_4C <chr>, LONGITUDE_BASE_4C <chr>,\n#   LATITUDE_BASE_DD <dbl>, LONGITUDE_BASE_DD <dbl>, DATUM_HORIZONTAL <chr>,\n#   TIPO_DE_COORDENADA_DE_BASE <chr>, DIRECAO <chr>,\n#   PROFUNDIDADE_VERTICAL_M <dbl>, PROFUNDIDADE_SONDADOR_M <dbl>,\n#   PROFUNDIDADE_MEDIDA_M <dbl>, REFERENCIA_DE_PROFUNDIDADE <chr>, …\n# ℹ Use `colnames()` to see all variable names\n```\n:::\n:::\n\n\n## Bibliotecas\n\nVamos carregar as bibliotecas que serão usadas na manipulação e visualização de dados.\n\nO pacote tidyverse carrega diversos pacotes muito uteis na manipulação e visualização de dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"tidyverse\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6     ✔ dplyr   1.0.9\n✔ tibble  3.1.8     ✔ stringr 1.4.0\n✔ tidyr   1.2.0     ✔ forcats 0.5.1\n✔ purrr   0.3.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n:::\n\n\nVamos primeiro conhecer o que tem na base de dados pocos. A base de dados possui 30255 linhas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(pocos)  # Tipo de base de dados\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"spec_tbl_df\" \"tbl_df\"      \"tbl\"         \"data.frame\" \n```\n:::\n\n```{.r .cell-code}\nsummary(pocos) # Sumario da base de dados\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     POCO             CADASTRO           OPERADOR         POCO_OPERADOR     \n Length:30255       Length:30255       Length:30255       Length:30255      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n    ESTADO             BACIA              BLOCO            SIG_CAMPO        \n Length:30255       Length:30255       Length:30255       Length:30255      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n    CAMPO            TERRA_MAR         POCO_POS_ANP           TIPO          \n Length:30255       Length:30255       Length:30255       Length:30255      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n  CATEGORIA         RECLASSIFICACAO      SITUACAO            INICIO         \n Length:30255       Length:30255       Length:30255       Length:30255      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n   TERMINO           CONCLUSAO         TITULARIDADE       LATITUDE_BASE_4C  \n Length:30255       Length:30255       Length:30255       Length:30255      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n LONGITUDE_BASE_4C  LATITUDE_BASE_DD  LONGITUDE_BASE_DD DATUM_HORIZONTAL  \n Length:30255       Min.   :-32.927   Min.   :-73.38    Length:30255      \n Class :character   1st Qu.:-12.691   1st Qu.:-39.61    Class :character  \n Mode  :character   Median :-10.710   Median :-37.83    Mode  :character  \n                    Mean   :-11.480   Mean   :-38.83                      \n                    3rd Qu.: -5.327   3rd Qu.:-36.98                      \n                    Max.   :  4.528   Max.   :-34.83                      \n                                                                          \n TIPO_DE_COORDENADA_DE_BASE   DIRECAO          PROFUNDIDADE_VERTICAL_M\n Length:30255               Length:30255       Min.   :-62550.0       \n Class :character           Class :character   1st Qu.:  -772.4       \n Mode  :character           Mode  :character   Median :     0.0       \n                                               Mean   :  -254.4       \n                                               3rd Qu.:   138.0       \n                                               Max.   :528084.0       \n                                               NA's   :19336          \n PROFUNDIDADE_SONDADOR_M PROFUNDIDADE_MEDIDA_M REFERENCIA_DE_PROFUNDIDADE\n Min.   :    0           Min.   :    0.0       Length:30255              \n 1st Qu.:  485           1st Qu.:  347.5       Class :character          \n Median :  999           Median :  870.2       Mode  :character          \n Mean   : 1507           Mean   : 1583.9                                 \n 3rd Qu.: 2230           3rd Qu.: 2644.0                                 \n Max.   :62750           Max.   :62800.0                                 \n NA's   :1043            NA's   :17787                                   \n MESA_ROTATIVA     COTA_ALTIMETRICA_M LAMINA_D_AGUA_M   DATUM_VERTICAL    \n Min.   :   0.00   Min.   :    0.00   Min.   :    0.0   Length:30255      \n 1st Qu.:  19.00   1st Qu.:    0.00   1st Qu.:    0.0   Class :character  \n Median :  32.40   Median :   12.30   Median :    0.0   Mode  :character  \n Mean   :  57.34   Mean   :   41.00   Mean   :  284.2                     \n 3rd Qu.:  75.68   3rd Qu.:   56.99   3rd Qu.:  116.0                     \n Max.   :2220.00   Max.   :30940.00   Max.   :30940.0                     \n                   NA's   :17225      NA's   :14761                       \n UNIDADE_ESTRATIGRAFICA GEOLOGIA_GRUPO_FINAL GEOLOGIA_FORMACAO_FINAL\n Mode:logical           Length:30255         Length:30255           \n NA's:30255             Class :character     Class :character       \n                        Mode  :character     Mode  :character       \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n GEOLOGIA_MEMBRO_FINAL     CDPE               AGP                 PC           \n Length:30255          Length:30255       Length:30255       Length:30255      \n Class :character      Class :character   Class :character   Class :character  \n Mode  :character      Mode  :character   Mode  :character   Mode  :character  \n                                                                               \n                                                                               \n                                                                               \n                                                                               \n     PAG            PERFIS_CONVENCIONAIS DURANTE_PERFURACAO PERFIS_DIGITAIS   \n Length:30255       Length:30255         Length:30255       Length:30255      \n Class :character   Class :character     Class :character   Class :character  \n Mode  :character   Mode  :character     Mode  :character   Mode  :character  \n                                                                              \n                                                                              \n                                                                              \n                                                                              \n PERFIS_PROCESSADOS PERFIS_ESPECIAIS   AMOSTRA_LATERAL      SISMICA         \n Length:30255       Length:30255       Length:30255       Length:30255      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n TABELA_TEMPO_PROFUNDIDADE DADOS_DIRECIONAIS  TESTE_A_CABO      \n Length:30255              Length:30255       Length:30255      \n Class :character          Class :character   Class :character  \n Mode  :character          Mode  :character   Mode  :character  \n                                                                \n                                                                \n                                                                \n                                                                \n TESTE_DE_FORMACAO   CANHONEIO          TESTEMUNHO         GEOQUIMICA       \n Length:30255       Length:30255       Length:30255       Length:30255      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n  SIG_SONDA          NOM_SONDA         DHA_ATUALIZACAO    ATINGIU_PRESAL    \n Length:30255       Length:30255       Length:30255       Length:30255      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n```\n:::\n:::\n\n\n## Dados de poços\n\nOs dados da tabela poços tem 60 colunas.\n\nVamos inicialmente selecionar algumas colunas para podermos trabalhar com os dados.\n\n**As colunas que vamos trabalhar são:**\n\n1)  POCO\n2)  OPERADOR\n3)  ESTADO\n4)  BACIA\n5)  BLOCO\n6)  CAMPO\n7)  TERRA_MAR\n8)  CATEGORIA\n9)  SITUACAO\n10) INICIO\n11) TERMINO\n12) PROFUNDIDADE_MEDIDA_M\n\nPara selecionar colunas usamos a função `select`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Vamos selecionar as colunas listadas acima\npocos_01 <- pocos %>% select(POCO,OPERADOR,ESTADO,BACIA,BLOCO, CAMPO,TERRA_MAR,CATEGORIA,SITUACAO, INICIO, TERMINO, PROFUNDIDADE_MEDIDA_M)\nhead(pocos_01)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 12\n  POCO   OPERA…¹ ESTADO BACIA BLOCO CAMPO TERRA…² CATEG…³ SITUA…⁴ INICIO TERMINO\n  <chr>  <chr>   <chr>  <chr> <chr> <chr> <chr>   <chr>   <chr>   <chr>  <chr>  \n1 7-PC-… 3R Mac… RN     Poti… PC    PORT… T       Desenv… ARRASA… 25/08… 27/08/…\n2 7-CO-… Petrob… RJ     Camp… CO    CORV… M       Desenv… ABANDO… 26/08… 11/10/…\n3 7-BA-… Petrob… BA     Recô… BA    BURA… T       Desenv… ABANDO… 28/08… 06/09/…\n4 7-ET-… Petrob… RN     Poti… ET    ESTR… T       Desenv… PRODUZ… 30/05… 31/05/…\n5 4-FSL… Petrob… ES     Espí… FSL   FAZE… T       Pionei… ABANDO… 31/05… 30/06/…\n6 7-CAM… Petrob… RN     Poti… CAM   CANT… T       Desenv… INJETA… 01/06… 04/06/…\n# … with 1 more variable: PROFUNDIDADE_MEDIDA_M <dbl>, and abbreviated variable\n#   names ¹​OPERADOR, ²​TERRA_MAR, ³​CATEGORIA, ⁴​SITUACAO\n# ℹ Use `colnames()` to see all variable names\n```\n:::\n:::\n\n\n## Manipulação de dados\n\nVamos eliminar as linhas de dados que apresenta dados ausentes \"NA\" nas colunas TERMINO e PROFUNDIDADE_MEDIDA_M.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(is.na(pocos_01))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 30235\n```\n:::\n\n```{.r .cell-code}\nsum(is.na(pocos_01$INICIO))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n\n```{.r .cell-code}\nsum(is.na(pocos_01$TERMINO))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1861\n```\n:::\n\n```{.r .cell-code}\nsum(is.na(pocos_01$PROFUNDIDADE_MEDIDA_M))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 17787\n```\n:::\n\n```{.r .cell-code}\npocos_01 <- pocos_01 %>% drop_na(any_of(c(\"TERMINO\",\n                                          \"PROFUNDIDADE_MEDIDA_M\")))\n# melhorando a visualização dos dados\nknitr::kable(\n  head(pocos_01, 10), booktabs = TRUE,\n  caption = 'Uma tabela mais elegante com as 10 primeras linhas de pocos_01.')\n```\n\n::: {.cell-output-display}\nTable: Uma tabela mais elegante com as 10 primeras linhas de pocos_01.\n\n|POCO          |OPERADOR  |ESTADO |BACIA    |BLOCO |CAMPO          |TERRA_MAR |CATEGORIA       |SITUACAO                   |INICIO           |TERMINO          | PROFUNDIDADE_MEDIDA_M|\n|:-------------|:---------|:------|:--------|:-----|:--------------|:---------|:---------------|:--------------------------|:----------------|:----------------|---------------------:|\n|1-MOR-1-RN    |Petrobras |RN     |Potiguar |BEN   |BENFICA        |T         |Pioneiro        |FECHADO                    |12/06/1994 00:00 |28/06/1994 00:00 |                   0.0|\n|7-REP-28-RN   |Petrobras |RN     |Potiguar |BEN   |BENFICA        |T         |Desenvolvimento |INJETANDO                  |12/04/1995 00:00 |18/04/1995 00:00 |                   0.0|\n|7-ET-647-RN   |Petrobras |RN     |Potiguar |ET    |ESTREITO       |T         |Desenvolvimento |INJETANDO                  |16/04/1995 00:00 |18/04/1995 00:00 |                 277.2|\n|7-MRL-54-RJS  |Petrobras |RJ     |Campos   |MRL   |MARLIM         |M         |Desenvolvimento |FECHADO                    |30/05/1996 00:00 |13/06/1996 00:00 |                   0.0|\n|7-BVS-13-RN   |Petrobras |RN     |Potiguar |BEN   |BENFICA        |T         |Desenvolvimento |FECHADO                    |06/06/1996 00:00 |15/06/1996 00:00 |                   0.0|\n|9-LUC-31D-AM  |Petrobras |AM     |Solimões |LUC   |LESTE DO URUCU |T         |Especial        |ABANDONADO PERMANENTEMENTE |10/06/1996 00:00 |15/08/1996 00:00 |                   0.0|\n|1-RJS-500-RJS |Petrobras |RJ     |Campos   |ESP   |ESPADARTE      |M         |Pioneiro        |ABANDONADO PERMANENTEMENTE |10/06/1996 00:00 |19/07/1996 00:00 |                   0.0|\n|8-MRL-36D-RJS |Petrobras |RJ     |Campos   |MRL   |MARLIM         |M         |Injeção         |FECHADO                    |27/10/1993 00:00 |15/11/1993 00:00 |                   0.0|\n|3-ESP-2-RJS   |Petrobras |RJ     |Campos   |ESP   |ESPADARTE      |M         |Extensão        |ABANDONADO PERMANENTEMENTE |09/05/1995 00:00 |19/06/1995 00:00 |                   0.0|\n|8-AB-49D-RJS  |Petrobras |RJ     |Campos   |AB    |ALBACORA       |M         |Injeção         |FECHADO                    |15/04/1996 00:00 |30/07/1996 00:00 |                   0.0|\n:::\n\n```{.r .cell-code}\nsum(is.na(pocos_01))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4328\n```\n:::\n:::\n\n\n**Veja que existia um grande número de dados ausentes**\n\nAntes: 30255 linhas Depois: 10715 linhas\n\n## Corrigindo tipo de dados\n\nAs colunas INICIO e TERMINO são datas, mas foram lidas como caracter, vamos corrigir isto!\n\nPara trabalhar com datas vamos usar o pacote `lubridate`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lubridate)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'lubridate'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    date, intersect, setdiff, union\n```\n:::\n\n```{.r .cell-code}\npocos_01$INICIO <- as_date(pocos_01$INICIO, format=\"%d/%m/%Y\")\npocos_01$TERMINO <- as_date(pocos_01$TERMINO, format=\"%d/%m/%Y\")\n```\n:::\n\n\n## Filtrando dados\n\nVamos analisar os poços de uma detreminada região, para isto podemos fltrar os poços de um bloco. Vamos filtrar somente os poços do CAMPO PEREGRINO usando a função `filter`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npocos_02 <- pocos_01 %>% filter(CAMPO==\"PEREGRINO\") ##  \nsummary(pocos_02)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     POCO             OPERADOR            ESTADO             BACIA          \n Length:94          Length:94          Length:94          Length:94         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n    BLOCO              CAMPO            TERRA_MAR          CATEGORIA        \n Length:94          Length:94          Length:94          Length:94         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n   SITUACAO             INICIO              TERMINO          \n Length:94          Min.   :1994-07-07   Min.   :1994-08-17  \n Class :character   1st Qu.:2011-12-16   1st Qu.:2012-01-27  \n Mode  :character   Median :2013-07-02   Median :2013-08-31  \n                    Mean   :2013-11-27   Mean   :2013-12-27  \n                    3rd Qu.:2015-10-06   3rd Qu.:2015-10-29  \n                    Max.   :2022-02-25   Max.   :2022-03-09  \n PROFUNDIDADE_MEDIDA_M\n Min.   :   0         \n 1st Qu.:4457         \n Median :4925         \n Mean   :5136         \n 3rd Qu.:6213         \n Max.   :8613         \n```\n:::\n\n```{.r .cell-code}\nknitr::kable(\n  head(pocos_02, 10), booktabs = TRUE,\n  caption = 'Uma tabela mais elegante com as 10 primeras linhas de pocos_02.')\n```\n\n::: {.cell-output-display}\nTable: Uma tabela mais elegante com as 10 primeras linhas de pocos_02.\n\n|POCO            |OPERADOR       |ESTADO |BACIA  |BLOCO  |CAMPO     |TERRA_MAR |CATEGORIA       |SITUACAO                   |INICIO     |TERMINO    | PROFUNDIDADE_MEDIDA_M|\n|:---------------|:--------------|:------|:------|:------|:---------|:---------|:---------------|:--------------------------|:----------|:----------|---------------------:|\n|1-RJS-498-RJS   |Equinor Brasil |RJ     |Campos |BM-C-7 |PEREGRINO |M         |Pioneiro        |ABANDONADO PERMANENTEMENTE |1994-07-07 |1994-08-17 |                  0.00|\n|7-PRG-2HB-RJS   |Equinor Brasil |RJ     |Campos |BM-C-7 |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2011-01-16 |2011-02-03 |               4676.00|\n|7-PRG-64HP-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2018-11-11 |2018-12-05 |               5790.00|\n|7-PRG-65HP-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |ABANDONADO PERMANENTEMENTE |2019-01-05 |2019-01-20 |               4386.00|\n|7-PRG-73HP-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2022-02-25 |2022-03-09 |               5694.00|\n|8-PRG-68H-RJS   |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Injeção         |EM AVALIAÇÃO               |2019-08-16 |2019-09-12 |               4133.00|\n|7-PRG-66HP-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2019-02-11 |2019-03-07 |               6529.00|\n|7-PRG-71HP-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |ABANDONADO PERMANENTEMENTE |2020-12-08 |2020-12-11 |               3646.00|\n|7-PRG-71HPA-RJS |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2020-12-18 |2020-01-06 |               5404.00|\n|7-PRG-40HP-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2014-07-27 |2014-08-03 |               4797.74|\n:::\n:::\n\n\n### Avaliando os dados\n\nOs poços possuem diversas categorias, vamos ver que categorias existem nestes poços do bloco BES-100.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(pocos_02$CATEGORIA)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Pioneiro\"        \"Desenvolvimento\" \"Injeção\"         \"Especial\"       \n[5] \"Extensão\"       \n```\n:::\n:::\n\n\n### Filtrando poços de desenvolvimento\n\n\n::: {.cell}\n\n```{.r .cell-code}\npocos_03 <- pocos_02 %>% filter(CATEGORIA==\"Desenvolvimento\") ##  \nsummary(pocos_03)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     POCO             OPERADOR            ESTADO             BACIA          \n Length:73          Length:73          Length:73          Length:73         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n    BLOCO              CAMPO            TERRA_MAR          CATEGORIA        \n Length:73          Length:73          Length:73          Length:73         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n   SITUACAO             INICIO              TERMINO          \n Length:73          Min.   :2010-11-10   Min.   :2010-11-11  \n Class :character   1st Qu.:2012-02-04   1st Qu.:2012-04-06  \n Mode  :character   Median :2013-10-20   Median :2013-11-15  \n                    Mean   :2014-07-23   Mean   :2014-08-21  \n                    3rd Qu.:2016-06-23   3rd Qu.:2016-08-27  \n                    Max.   :2022-02-25   Max.   :2022-03-09  \n PROFUNDIDADE_MEDIDA_M\n Min.   : 742         \n 1st Qu.:4543         \n Median :5066         \n Mean   :5385         \n 3rd Qu.:6383         \n Max.   :8613         \n```\n:::\n\n```{.r .cell-code}\nknitr::kable(\n  head(pocos_03, 10), booktabs = TRUE,\n  caption = 'Uma tabela mais elegante com as 10 primeras linhas de pocos_03.')\n```\n\n::: {.cell-output-display}\nTable: Uma tabela mais elegante com as 10 primeras linhas de pocos_03.\n\n|POCO            |OPERADOR       |ESTADO |BACIA  |BLOCO  |CAMPO     |TERRA_MAR |CATEGORIA       |SITUACAO                   |INICIO     |TERMINO    | PROFUNDIDADE_MEDIDA_M|\n|:---------------|:--------------|:------|:------|:------|:---------|:---------|:---------------|:--------------------------|:----------|:----------|---------------------:|\n|7-PRG-2HB-RJS   |Equinor Brasil |RJ     |Campos |BM-C-7 |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2011-01-16 |2011-02-03 |               4676.00|\n|7-PRG-64HP-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2018-11-11 |2018-12-05 |               5790.00|\n|7-PRG-65HP-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |ABANDONADO PERMANENTEMENTE |2019-01-05 |2019-01-20 |               4386.00|\n|7-PRG-73HP-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2022-02-25 |2022-03-09 |               5694.00|\n|7-PRG-66HP-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2019-02-11 |2019-03-07 |               6529.00|\n|7-PRG-71HP-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |ABANDONADO PERMANENTEMENTE |2020-12-08 |2020-12-11 |               3646.00|\n|7-PRG-71HPA-RJS |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2020-12-18 |2020-01-06 |               5404.00|\n|7-PRG-40HP-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2014-07-27 |2014-08-03 |               4797.74|\n|7-PRG-8HPA-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |ABANDONADO PERMANENTEMENTE |2011-11-07 |2011-12-02 |               4959.87|\n|7-PRG-72HP-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2021-11-17 |2021-12-08 |               5302.00|\n:::\n:::\n\n\n## Criando uma coluna com mutate\n\nVamos criar uma coluna que nos dará a duração da perfuração dos poços.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npocos_03$INICIO[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2011-01-16\"\n```\n:::\n\n```{.r .cell-code}\npocos_03$TERMINO[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2011-02-03\"\n```\n:::\n\n```{.r .cell-code}\npocos_03$TERMINO[1] - pocos_03$INICIO[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTime difference of 18 days\n```\n:::\n\n```{.r .cell-code}\ndifftime(pocos_03$TERMINO[1], pocos_03$INICIO[1], units = \"days\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTime difference of 18 days\n```\n:::\n\n```{.r .cell-code}\ntempo <- difftime(pocos_03$TERMINO[1], pocos_03$INICIO[1], units = \"days\")\nstr(tempo)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n 'difftime' num 18\n - attr(*, \"units\")= chr \"days\"\n```\n:::\n\n```{.r .cell-code}\n(pocos_03$INICIO[1] %--% pocos_03$TERMINO[1])/ddays(1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 18\n```\n:::\n\n```{.r .cell-code}\npocos_03 <- pocos_03 %>% mutate(TPERF = (INICIO %--% TERMINO)/ddays(1))\nsummary(pocos_03)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     POCO             OPERADOR            ESTADO             BACIA          \n Length:73          Length:73          Length:73          Length:73         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n    BLOCO              CAMPO            TERRA_MAR          CATEGORIA        \n Length:73          Length:73          Length:73          Length:73         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n   SITUACAO             INICIO              TERMINO          \n Length:73          Min.   :2010-11-10   Min.   :2010-11-11  \n Class :character   1st Qu.:2012-02-04   1st Qu.:2012-04-06  \n Mode  :character   Median :2013-10-20   Median :2013-11-15  \n                    Mean   :2014-07-23   Mean   :2014-08-21  \n                    3rd Qu.:2016-06-23   3rd Qu.:2016-08-27  \n                    Max.   :2022-02-25   Max.   :2022-03-09  \n PROFUNDIDADE_MEDIDA_M     TPERF       \n Min.   : 742          Min.   :-347.0  \n 1st Qu.:4543          1st Qu.:  16.0  \n Median :5066          Median :  24.0  \n Mean   :5385          Mean   :  28.9  \n 3rd Qu.:6383          3rd Qu.:  37.0  \n Max.   :8613          Max.   : 260.0  \n```\n:::\n:::\n\n\n### Eliminando colunas com tempos negativos\n\n\n::: {.cell}\n\n```{.r .cell-code}\npocos_03 <- pocos_03 %>% filter(TPERF > 0) \n```\n:::\n\n\n## Visualizando os dados de PEREGRINO\n\n### Box-Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pocos_03, aes(x=CAMPO, y=TPERF)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](imagens/Aula01/boxplot-1.png){width=960}\n:::\n:::\n\n\nVeja que existem alguns tempos bem elevados que estão representados por pontos no box-plot. Eles podem ser considerados pontos afastados (outliers), que neste caso vamos eliminar.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npocos_04 <- pocos_03 %>% filter(TPERF < 100)\nggplot(pocos_04, aes(x=CAMPO, y=TPERF)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](imagens/Aula01/outliers-1.png){width=960}\n:::\n:::\n\n\n### Histograma\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pocos_04, aes(x=TPERF)) +\n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](imagens/Aula01/histograma-1.png){width=960}\n:::\n:::\n\n\nVeja que desta forma o ggplot usa o seu padrão de 30 faixas de dados, que geralmente não é o mais adequado.\n\nVamos usar uma regra adequada para definição de número de faixas.\n\n### Criando um histograma usando a regra de Sturges\n\nA regra de Sturges indica 7 faixas enquanto que o padrão do ggplot2 é 30.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pocos_04, aes(x = TPERF)) +\n  geom_histogram(bins = round(1+3.322*log10(nrow(pocos_04)),0))\n```\n\n::: {.cell-output-display}\n![](imagens/Aula01/Sturges-1.png){width=960}\n:::\n:::\n\n\nVeja que agora temos um histograma mais suave.\n\n### Gráfico de Dispersão\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pocos_04, aes(x=PROFUNDIDADE_MEDIDA_M, y=TPERF)) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![](imagens/Aula01/dispersao-1.png){width=960}\n:::\n:::\n\n\nPodemos perceber que há uma relação entre o tempo de perfuração e a profundidade do poço.\n\nTambém é possível se perceber que ainda existem dados com comportamentos estranhos. Poços rasos com profundidade muito diferente dos demais, além disso um poço muito profundo com duração muito pequena.\n\nSe fossemos construir um modelo certamente terímos que investigar o porque destes comportamentos.\n\n### Alterando nome das colunas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(pocos_04)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"POCO\"                  \"OPERADOR\"              \"ESTADO\"               \n [4] \"BACIA\"                 \"BLOCO\"                 \"CAMPO\"                \n [7] \"TERRA_MAR\"             \"CATEGORIA\"             \"SITUACAO\"             \n[10] \"INICIO\"                \"TERMINO\"               \"PROFUNDIDADE_MEDIDA_M\"\n[13] \"TPERF\"                \n```\n:::\n\n```{.r .cell-code}\nnames(pocos_04) <- tolower(names(pocos_04))\nnames(pocos_04)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"poco\"                  \"operador\"              \"estado\"               \n [4] \"bacia\"                 \"bloco\"                 \"campo\"                \n [7] \"terra_mar\"             \"categoria\"             \"situacao\"             \n[10] \"inicio\"                \"termino\"               \"profundidade_medida_m\"\n[13] \"tperf\"                \n```\n:::\n:::\n",
    "supporting": [
      "Aula01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}