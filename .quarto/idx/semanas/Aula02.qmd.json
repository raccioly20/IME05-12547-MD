{"title":"Manipulação dos dados","markdown":{"yaml":{"title":"Manipulação dos dados","author":"Ricardo Accioly","date":"`r Sys.Date()`","output":{"html_document":{"toc":"yes","code_download":"yes"}}},"headingText":"Carregando bibliotescas","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE, fig.retina = 3, fig.height = 6,\n                      dev=c(\"png\"), fig.path=\"imagens/Aula02/\")\n```\n\n\nVamos trabalhar de novo com os dados do gapminder para fazer algumas manipulações de dados que são muito úteis no dia a dia. \n\nEste material foi em parte adaptado do curso Data Visualization in R with ggplot2 de Kara Woo\n\n```{r carregando_bibliotecas, message=FALSE, warning=FALSE}\nlibrary(\"gapminder\")\nlibrary(\"dplyr\")\nlibrary(\"ggplot2\")\nlibrary(\"patchwork\")\n```\n\n\n## Filtrando 2007\n\n```{r filtro_2007}\n## Cria um extrato do ano de 2007\ndata(gapminder)\nsummary(gapminder)\ngap_07 <- filter(gapminder, year == 2007)\n```\n\n## Vendo primeiras e últimas 10 linhas\n\n```{r linhas_iniciais_finais, message=FALSE, warning=FALSE}\nhead(gap_07, n=10) %>% knitr::kable(booktabs = TRUE) # primeiros dez paises da base de dados\ntail(gap_07, n=10) %>% knitr::kable(booktabs = TRUE) # últimos 10 países \n```\n\n\n\\newpage\n\n## Manipulando 1 \n\nSelecionando dados por país\n\n```{r filtro_Brasil_Chile}\nfilter(gap_07, country %in% c(\"Brazil\", \"Chile\"))\n```\n\n## Manipulando 2 \n\nSelecionando dados para 2007 excluindo a Oceania\n\n```{r filtro_excluicontinente}\n\nfilter(gapminder, year == 2007 & continent != \"Oceania\")\n\n```\n\n\n\\newpage\n\n## Manipulando 3\n\nSelecionando dados de  2007, agrupando por continente e sumarizando para achar a média da população por continente\n\n```{r agrupando_media, message=FALSE}\ngapminder %>%\n  filter(year == 2007) %>% \n  group_by(continent) %>% \n  summarize(mediapop = mean(pop))\n```\n\n\n\n## Visualizando 1\n\nMostrar linhas e pontos do PIB ao longo do tempo para Brasil e Chile\n\n```{r graf1}\ngap_brachi <- filter(gapminder, country %in% c(\"Brazil\", \"Chile\"))\np <- ggplot(gap_brachi, aes(x = year, y = gdpPercap, color=country))\np1 <- p + geom_point()\np1\n```\n\n\n\\newpage\n\n##  Visualizando 2\n\n```{r graf2}\np2 <- p + geom_line()\np2\n```\n\n\n## Visualizando 3\n\n```{r graf3}\np3 <- p + geom_point() + geom_line()\np3\n```\n\n\\newpage\n\n## Visualizando 4 - Usando o pacote patchwork\n\n```{r graf4}\n(p1 + p2) /\n  p3\n```\n\n\n## Manipulando 4 \n\nContando número de países e continentes com distinct\n\n```{r distinct}\nnrow(gapminder) ## Esta não é a informação que eu quero\nhead(gapminder)\nnrow(distinct(gapminder,country))\nnrow(distinct(gapminder, continent))\n\n```\n\n\n## Fazendo contagens de dados\n\n```{r contagem, message=FALSE}\ngapminder %>% filter(year == 2007) %>% \n  group_by(continent) %>% summarise(n = n())\n\n```\n\n\n\\newpage\n\n## Mudando orientação dos dados\n\n```{r pivot1}\nlibrary(readxl)\npropaganda <- read_excel(\"Propaganda.xlsx\")\nhead(propaganda)\npropaganda <- propaganda %>% rename(Jornal = Newspaper, Vendas = Sales)\npropaganda %>% tidyr::pivot_longer(!Vendas, names_to=\"Midia\", values_to=\"Orcamento\")\n```\n\n\\newpage\n\n\n```{r pivot2}\nlibrary(readr)\npesquisa <- read.csv(\"data_joined.csv\", header = T)\nhead(pesquisa)\npesquisa_gw <- pesquisa %>% filter(!is.na(weight)) %>%\n  group_by(year, genus) %>%\n  summarize(peso_medio = mean(weight))\nhead(pesquisa_gw)\npesquisa_gw %>% tidyr::pivot_wider(names_from=\"genus\", values_from=\"peso_medio\")\n```\n\n\n\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":{"html_document":{"toc":"yes","code_download":"yes"}},"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"output-file":"Aula02.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.38","editor":"visual","theme":{"light":["cosmo","../theme.scss"],"dark":["cosmo","../theme-dark.scss"]},"mainfont":"Atkinson Hyperlegible","code-copy":true,"title":"Manipulação dos dados","author":"Ricardo Accioly","date":"`r Sys.Date()`"},"extensions":{"book":{"multiFile":true}}}}}