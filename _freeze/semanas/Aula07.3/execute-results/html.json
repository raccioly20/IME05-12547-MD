{
  "hash": "87a762f72b8f99c946e06bea4a76c8e9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Seleção de Modelos\"\nauthor: \"Ricardo Accioly\"\ndate: \"2024-03-05\"\nformat:\n html:\n    code-link: true\n---\n\n\n## Carregando Bibliotecas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MASS)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n✖ dplyr::select() masks MASS::select()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(leaps)\n```\n:::\n\n\n## Carregando os dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(Boston)\nhead(Boston)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     crim zn indus chas   nox    rm  age    dis rad tax ptratio  black lstat\n1 0.00632 18  2.31    0 0.538 6.575 65.2 4.0900   1 296    15.3 396.90  4.98\n2 0.02731  0  7.07    0 0.469 6.421 78.9 4.9671   2 242    17.8 396.90  9.14\n3 0.02729  0  7.07    0 0.469 7.185 61.1 4.9671   2 242    17.8 392.83  4.03\n4 0.03237  0  2.18    0 0.458 6.998 45.8 6.0622   3 222    18.7 394.63  2.94\n5 0.06905  0  2.18    0 0.458 7.147 54.2 6.0622   3 222    18.7 396.90  5.33\n6 0.02985  0  2.18    0 0.458 6.430 58.7 6.0622   3 222    18.7 394.12  5.21\n  medv\n1 24.0\n2 21.6\n3 34.7\n4 33.4\n5 36.2\n6 28.7\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(Boston)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      crim                zn             indus            chas        \n Min.   : 0.00632   Min.   :  0.00   Min.   : 0.46   Min.   :0.00000  \n 1st Qu.: 0.08205   1st Qu.:  0.00   1st Qu.: 5.19   1st Qu.:0.00000  \n Median : 0.25651   Median :  0.00   Median : 9.69   Median :0.00000  \n Mean   : 3.61352   Mean   : 11.36   Mean   :11.14   Mean   :0.06917  \n 3rd Qu.: 3.67708   3rd Qu.: 12.50   3rd Qu.:18.10   3rd Qu.:0.00000  \n Max.   :88.97620   Max.   :100.00   Max.   :27.74   Max.   :1.00000  \n      nox               rm             age              dis        \n Min.   :0.3850   Min.   :3.561   Min.   :  2.90   Min.   : 1.130  \n 1st Qu.:0.4490   1st Qu.:5.886   1st Qu.: 45.02   1st Qu.: 2.100  \n Median :0.5380   Median :6.208   Median : 77.50   Median : 3.207  \n Mean   :0.5547   Mean   :6.285   Mean   : 68.57   Mean   : 3.795  \n 3rd Qu.:0.6240   3rd Qu.:6.623   3rd Qu.: 94.08   3rd Qu.: 5.188  \n Max.   :0.8710   Max.   :8.780   Max.   :100.00   Max.   :12.127  \n      rad              tax           ptratio          black       \n Min.   : 1.000   Min.   :187.0   Min.   :12.60   Min.   :  0.32  \n 1st Qu.: 4.000   1st Qu.:279.0   1st Qu.:17.40   1st Qu.:375.38  \n Median : 5.000   Median :330.0   Median :19.05   Median :391.44  \n Mean   : 9.549   Mean   :408.2   Mean   :18.46   Mean   :356.67  \n 3rd Qu.:24.000   3rd Qu.:666.0   3rd Qu.:20.20   3rd Qu.:396.23  \n Max.   :24.000   Max.   :711.0   Max.   :22.00   Max.   :396.90  \n     lstat            medv      \n Min.   : 1.73   Min.   : 5.00  \n 1st Qu.: 6.95   1st Qu.:17.02  \n Median :11.36   Median :21.20  \n Mean   :12.65   Mean   :22.53  \n 3rd Qu.:16.95   3rd Qu.:25.00  \n Max.   :37.97   Max.   :50.00  \n```\n\n\n:::\n\n```{.r .cell-code}\nnrow(Boston)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 506\n```\n\n\n:::\n:::\n\n\n## Explicação das variáveis\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Boston Database\n# \n# 1) crim - taxa de criminalidade per capita por cidade.\n# \n# 2) zn - proporção de terrenos residenciais para lotes acima de 25,000 sq.ft.\n# \n# 3) indus - proporção de negócios não comerciais por acres e por cidade.\n# \n# 4) chas - variável dummy do Rio Charles (= 1 se próximo do rio; 0 de outra forma).\n# \n# 5) nox - concentração de óxido de nitrogênio (partes por 10 milhões).\n# \n# 6) rm - número médio de cômodos por habitação\n# \n# 7) age - proporção da unidade ocupadas pelos proprietários construídas antes 1940.\n# \n# 8) dis - média ponderada das distâncias dos 5 pontos de emprego em Boston.\n# \n# 9) rad - indice de acessibilidade das avenidas radiais.\n# \n# 10) tax - valor cheio da taxa de propriedade por $10,000.\n# \n# 11) ptratio - razão aluno-professor por cidade.\n# \n# 12) black - 1000(Bk−0.63)21000(Bk−0.63)2 proporção de negros por cidade.\n# \n# 13) lstat - percentual de baixo status da população.\n# \n# 14) medv - valor mediano das casas ocupadas pelos proprietário em $1000s. (Var. Resposta)\n```\n:::\n\n\n## Conjunto de teste e treino\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(caret)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCarregando pacotes exigidos: lattice\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'caret'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:purrr':\n\n    lift\n```\n\n\n:::\n\n```{.r .cell-code}\nset.seed(21)\ny <- Boston$medv\nindice_teste <- createDataPartition(y, times = 1, p = 0.2, list = FALSE)\n\nconj_treino <- Boston[-indice_teste,]\nconj_teste <- Boston[indice_teste, ]\n\nstr(conj_treino)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t403 obs. of  14 variables:\n $ crim   : num  0.00632 0.02731 0.02729 0.03237 0.06905 ...\n $ zn     : num  18 0 0 0 0 0 12.5 12.5 12.5 12.5 ...\n $ indus  : num  2.31 7.07 7.07 2.18 2.18 2.18 7.87 7.87 7.87 7.87 ...\n $ chas   : int  0 0 0 0 0 0 0 0 0 0 ...\n $ nox    : num  0.538 0.469 0.469 0.458 0.458 0.458 0.524 0.524 0.524 0.524 ...\n $ rm     : num  6.58 6.42 7.18 7 7.15 ...\n $ age    : num  65.2 78.9 61.1 45.8 54.2 58.7 66.6 96.1 85.9 94.3 ...\n $ dis    : num  4.09 4.97 4.97 6.06 6.06 ...\n $ rad    : int  1 2 2 3 3 3 5 5 5 5 ...\n $ tax    : num  296 242 242 222 222 222 311 311 311 311 ...\n $ ptratio: num  15.3 17.8 17.8 18.7 18.7 18.7 15.2 15.2 15.2 15.2 ...\n $ black  : num  397 397 393 395 397 ...\n $ lstat  : num  4.98 9.14 4.03 2.94 5.33 ...\n $ medv   : num  24 21.6 34.7 33.4 36.2 28.7 22.9 27.1 18.9 15 ...\n```\n\n\n:::\n\n```{.r .cell-code}\nstr(conj_teste)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t103 obs. of  14 variables:\n $ crim   : num  0.211 0.63 0.627 1.252 0.852 ...\n $ zn     : num  12.5 0 0 0 0 0 0 75 0 0 ...\n $ indus  : num  7.87 8.14 8.14 8.14 8.14 8.14 8.14 2.95 6.91 6.91 ...\n $ chas   : int  0 0 0 0 0 0 0 0 0 0 ...\n $ nox    : num  0.524 0.538 0.538 0.538 0.538 0.538 0.538 0.428 0.448 0.448 ...\n $ rm     : num  5.63 5.95 5.83 5.57 5.96 ...\n $ age    : num  100 61.8 56.5 98.1 89.2 94.1 96.9 21.8 6.5 95.3 ...\n $ dis    : num  6.08 4.71 4.5 3.8 4.01 ...\n $ rad    : int  5 4 4 4 4 4 4 3 3 3 ...\n $ tax    : num  311 307 307 307 307 307 307 252 233 233 ...\n $ ptratio: num  15.2 21 21 21 21 21 21 18.3 17.9 17.9 ...\n $ black  : num  387 397 396 377 393 ...\n $ lstat  : num  29.93 8.26 8.47 21.02 13.83 ...\n $ medv   : num  16.5 20.4 19.9 13.6 19.6 12.7 13.5 30.8 24.7 14.4 ...\n```\n\n\n:::\n\n```{.r .cell-code}\ngt::gt(head(conj_treino, 10))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ryhgivfqvc\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ryhgivfqvc table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ryhgivfqvc thead, #ryhgivfqvc tbody, #ryhgivfqvc tfoot, #ryhgivfqvc tr, #ryhgivfqvc td, #ryhgivfqvc th {\n  border-style: none;\n}\n\n#ryhgivfqvc p {\n  margin: 0;\n  padding: 0;\n}\n\n#ryhgivfqvc .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ryhgivfqvc .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ryhgivfqvc .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ryhgivfqvc .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ryhgivfqvc .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ryhgivfqvc .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ryhgivfqvc .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ryhgivfqvc .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ryhgivfqvc .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ryhgivfqvc .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ryhgivfqvc .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ryhgivfqvc .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ryhgivfqvc .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ryhgivfqvc .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ryhgivfqvc .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ryhgivfqvc .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ryhgivfqvc .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ryhgivfqvc .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ryhgivfqvc .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ryhgivfqvc .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ryhgivfqvc .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ryhgivfqvc .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ryhgivfqvc .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ryhgivfqvc .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ryhgivfqvc .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ryhgivfqvc .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ryhgivfqvc .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ryhgivfqvc .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ryhgivfqvc .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ryhgivfqvc .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ryhgivfqvc .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ryhgivfqvc .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ryhgivfqvc .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ryhgivfqvc .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ryhgivfqvc .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ryhgivfqvc .gt_left {\n  text-align: left;\n}\n\n#ryhgivfqvc .gt_center {\n  text-align: center;\n}\n\n#ryhgivfqvc .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ryhgivfqvc .gt_font_normal {\n  font-weight: normal;\n}\n\n#ryhgivfqvc .gt_font_bold {\n  font-weight: bold;\n}\n\n#ryhgivfqvc .gt_font_italic {\n  font-style: italic;\n}\n\n#ryhgivfqvc .gt_super {\n  font-size: 65%;\n}\n\n#ryhgivfqvc .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ryhgivfqvc .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ryhgivfqvc .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ryhgivfqvc .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ryhgivfqvc .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ryhgivfqvc .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ryhgivfqvc .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"crim\">crim</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"zn\">zn</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"indus\">indus</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"chas\">chas</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"nox\">nox</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rm\">rm</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"age\">age</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"dis\">dis</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rad\">rad</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"tax\">tax</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ptratio\">ptratio</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"black\">black</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"lstat\">lstat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"medv\">medv</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"crim\" class=\"gt_row gt_right\">0.00632</td>\n<td headers=\"zn\" class=\"gt_row gt_right\">18.0</td>\n<td headers=\"indus\" class=\"gt_row gt_right\">2.31</td>\n<td headers=\"chas\" class=\"gt_row gt_right\">0</td>\n<td headers=\"nox\" class=\"gt_row gt_right\">0.538</td>\n<td headers=\"rm\" class=\"gt_row gt_right\">6.575</td>\n<td headers=\"age\" class=\"gt_row gt_right\">65.2</td>\n<td headers=\"dis\" class=\"gt_row gt_right\">4.0900</td>\n<td headers=\"rad\" class=\"gt_row gt_right\">1</td>\n<td headers=\"tax\" class=\"gt_row gt_right\">296</td>\n<td headers=\"ptratio\" class=\"gt_row gt_right\">15.3</td>\n<td headers=\"black\" class=\"gt_row gt_right\">396.90</td>\n<td headers=\"lstat\" class=\"gt_row gt_right\">4.98</td>\n<td headers=\"medv\" class=\"gt_row gt_right\">24.0</td></tr>\n    <tr><td headers=\"crim\" class=\"gt_row gt_right\">0.02731</td>\n<td headers=\"zn\" class=\"gt_row gt_right\">0.0</td>\n<td headers=\"indus\" class=\"gt_row gt_right\">7.07</td>\n<td headers=\"chas\" class=\"gt_row gt_right\">0</td>\n<td headers=\"nox\" class=\"gt_row gt_right\">0.469</td>\n<td headers=\"rm\" class=\"gt_row gt_right\">6.421</td>\n<td headers=\"age\" class=\"gt_row gt_right\">78.9</td>\n<td headers=\"dis\" class=\"gt_row gt_right\">4.9671</td>\n<td headers=\"rad\" class=\"gt_row gt_right\">2</td>\n<td headers=\"tax\" class=\"gt_row gt_right\">242</td>\n<td headers=\"ptratio\" class=\"gt_row gt_right\">17.8</td>\n<td headers=\"black\" class=\"gt_row gt_right\">396.90</td>\n<td headers=\"lstat\" class=\"gt_row gt_right\">9.14</td>\n<td headers=\"medv\" class=\"gt_row gt_right\">21.6</td></tr>\n    <tr><td headers=\"crim\" class=\"gt_row gt_right\">0.02729</td>\n<td headers=\"zn\" class=\"gt_row gt_right\">0.0</td>\n<td headers=\"indus\" class=\"gt_row gt_right\">7.07</td>\n<td headers=\"chas\" class=\"gt_row gt_right\">0</td>\n<td headers=\"nox\" class=\"gt_row gt_right\">0.469</td>\n<td headers=\"rm\" class=\"gt_row gt_right\">7.185</td>\n<td headers=\"age\" class=\"gt_row gt_right\">61.1</td>\n<td headers=\"dis\" class=\"gt_row gt_right\">4.9671</td>\n<td headers=\"rad\" class=\"gt_row gt_right\">2</td>\n<td headers=\"tax\" class=\"gt_row gt_right\">242</td>\n<td headers=\"ptratio\" class=\"gt_row gt_right\">17.8</td>\n<td headers=\"black\" class=\"gt_row gt_right\">392.83</td>\n<td headers=\"lstat\" class=\"gt_row gt_right\">4.03</td>\n<td headers=\"medv\" class=\"gt_row gt_right\">34.7</td></tr>\n    <tr><td headers=\"crim\" class=\"gt_row gt_right\">0.03237</td>\n<td headers=\"zn\" class=\"gt_row gt_right\">0.0</td>\n<td headers=\"indus\" class=\"gt_row gt_right\">2.18</td>\n<td headers=\"chas\" class=\"gt_row gt_right\">0</td>\n<td headers=\"nox\" class=\"gt_row gt_right\">0.458</td>\n<td headers=\"rm\" class=\"gt_row gt_right\">6.998</td>\n<td headers=\"age\" class=\"gt_row gt_right\">45.8</td>\n<td headers=\"dis\" class=\"gt_row gt_right\">6.0622</td>\n<td headers=\"rad\" class=\"gt_row gt_right\">3</td>\n<td headers=\"tax\" class=\"gt_row gt_right\">222</td>\n<td headers=\"ptratio\" class=\"gt_row gt_right\">18.7</td>\n<td headers=\"black\" class=\"gt_row gt_right\">394.63</td>\n<td headers=\"lstat\" class=\"gt_row gt_right\">2.94</td>\n<td headers=\"medv\" class=\"gt_row gt_right\">33.4</td></tr>\n    <tr><td headers=\"crim\" class=\"gt_row gt_right\">0.06905</td>\n<td headers=\"zn\" class=\"gt_row gt_right\">0.0</td>\n<td headers=\"indus\" class=\"gt_row gt_right\">2.18</td>\n<td headers=\"chas\" class=\"gt_row gt_right\">0</td>\n<td headers=\"nox\" class=\"gt_row gt_right\">0.458</td>\n<td headers=\"rm\" class=\"gt_row gt_right\">7.147</td>\n<td headers=\"age\" class=\"gt_row gt_right\">54.2</td>\n<td headers=\"dis\" class=\"gt_row gt_right\">6.0622</td>\n<td headers=\"rad\" class=\"gt_row gt_right\">3</td>\n<td headers=\"tax\" class=\"gt_row gt_right\">222</td>\n<td headers=\"ptratio\" class=\"gt_row gt_right\">18.7</td>\n<td headers=\"black\" class=\"gt_row gt_right\">396.90</td>\n<td headers=\"lstat\" class=\"gt_row gt_right\">5.33</td>\n<td headers=\"medv\" class=\"gt_row gt_right\">36.2</td></tr>\n    <tr><td headers=\"crim\" class=\"gt_row gt_right\">0.02985</td>\n<td headers=\"zn\" class=\"gt_row gt_right\">0.0</td>\n<td headers=\"indus\" class=\"gt_row gt_right\">2.18</td>\n<td headers=\"chas\" class=\"gt_row gt_right\">0</td>\n<td headers=\"nox\" class=\"gt_row gt_right\">0.458</td>\n<td headers=\"rm\" class=\"gt_row gt_right\">6.430</td>\n<td headers=\"age\" class=\"gt_row gt_right\">58.7</td>\n<td headers=\"dis\" class=\"gt_row gt_right\">6.0622</td>\n<td headers=\"rad\" class=\"gt_row gt_right\">3</td>\n<td headers=\"tax\" class=\"gt_row gt_right\">222</td>\n<td headers=\"ptratio\" class=\"gt_row gt_right\">18.7</td>\n<td headers=\"black\" class=\"gt_row gt_right\">394.12</td>\n<td headers=\"lstat\" class=\"gt_row gt_right\">5.21</td>\n<td headers=\"medv\" class=\"gt_row gt_right\">28.7</td></tr>\n    <tr><td headers=\"crim\" class=\"gt_row gt_right\">0.08829</td>\n<td headers=\"zn\" class=\"gt_row gt_right\">12.5</td>\n<td headers=\"indus\" class=\"gt_row gt_right\">7.87</td>\n<td headers=\"chas\" class=\"gt_row gt_right\">0</td>\n<td headers=\"nox\" class=\"gt_row gt_right\">0.524</td>\n<td headers=\"rm\" class=\"gt_row gt_right\">6.012</td>\n<td headers=\"age\" class=\"gt_row gt_right\">66.6</td>\n<td headers=\"dis\" class=\"gt_row gt_right\">5.5605</td>\n<td headers=\"rad\" class=\"gt_row gt_right\">5</td>\n<td headers=\"tax\" class=\"gt_row gt_right\">311</td>\n<td headers=\"ptratio\" class=\"gt_row gt_right\">15.2</td>\n<td headers=\"black\" class=\"gt_row gt_right\">395.60</td>\n<td headers=\"lstat\" class=\"gt_row gt_right\">12.43</td>\n<td headers=\"medv\" class=\"gt_row gt_right\">22.9</td></tr>\n    <tr><td headers=\"crim\" class=\"gt_row gt_right\">0.14455</td>\n<td headers=\"zn\" class=\"gt_row gt_right\">12.5</td>\n<td headers=\"indus\" class=\"gt_row gt_right\">7.87</td>\n<td headers=\"chas\" class=\"gt_row gt_right\">0</td>\n<td headers=\"nox\" class=\"gt_row gt_right\">0.524</td>\n<td headers=\"rm\" class=\"gt_row gt_right\">6.172</td>\n<td headers=\"age\" class=\"gt_row gt_right\">96.1</td>\n<td headers=\"dis\" class=\"gt_row gt_right\">5.9505</td>\n<td headers=\"rad\" class=\"gt_row gt_right\">5</td>\n<td headers=\"tax\" class=\"gt_row gt_right\">311</td>\n<td headers=\"ptratio\" class=\"gt_row gt_right\">15.2</td>\n<td headers=\"black\" class=\"gt_row gt_right\">396.90</td>\n<td headers=\"lstat\" class=\"gt_row gt_right\">19.15</td>\n<td headers=\"medv\" class=\"gt_row gt_right\">27.1</td></tr>\n    <tr><td headers=\"crim\" class=\"gt_row gt_right\">0.17004</td>\n<td headers=\"zn\" class=\"gt_row gt_right\">12.5</td>\n<td headers=\"indus\" class=\"gt_row gt_right\">7.87</td>\n<td headers=\"chas\" class=\"gt_row gt_right\">0</td>\n<td headers=\"nox\" class=\"gt_row gt_right\">0.524</td>\n<td headers=\"rm\" class=\"gt_row gt_right\">6.004</td>\n<td headers=\"age\" class=\"gt_row gt_right\">85.9</td>\n<td headers=\"dis\" class=\"gt_row gt_right\">6.5921</td>\n<td headers=\"rad\" class=\"gt_row gt_right\">5</td>\n<td headers=\"tax\" class=\"gt_row gt_right\">311</td>\n<td headers=\"ptratio\" class=\"gt_row gt_right\">15.2</td>\n<td headers=\"black\" class=\"gt_row gt_right\">386.71</td>\n<td headers=\"lstat\" class=\"gt_row gt_right\">17.10</td>\n<td headers=\"medv\" class=\"gt_row gt_right\">18.9</td></tr>\n    <tr><td headers=\"crim\" class=\"gt_row gt_right\">0.22489</td>\n<td headers=\"zn\" class=\"gt_row gt_right\">12.5</td>\n<td headers=\"indus\" class=\"gt_row gt_right\">7.87</td>\n<td headers=\"chas\" class=\"gt_row gt_right\">0</td>\n<td headers=\"nox\" class=\"gt_row gt_right\">0.524</td>\n<td headers=\"rm\" class=\"gt_row gt_right\">6.377</td>\n<td headers=\"age\" class=\"gt_row gt_right\">94.3</td>\n<td headers=\"dis\" class=\"gt_row gt_right\">6.3467</td>\n<td headers=\"rad\" class=\"gt_row gt_right\">5</td>\n<td headers=\"tax\" class=\"gt_row gt_right\">311</td>\n<td headers=\"ptratio\" class=\"gt_row gt_right\">15.2</td>\n<td headers=\"black\" class=\"gt_row gt_right\">392.52</td>\n<td headers=\"lstat\" class=\"gt_row gt_right\">20.45</td>\n<td headers=\"medv\" class=\"gt_row gt_right\">15.0</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n## Matriz de correlação\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(corrplot)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\ncorrplot 0.92 loaded\n```\n\n\n:::\n\n```{.r .cell-code}\nmat_corr <- cor(conj_treino)\ncorrplot(mat_corr)\n```\n\n::: {.cell-output-display}\n![](Aula07.3_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nmat_corr\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               crim          zn      indus        chas        nox         rm\ncrim     1.00000000 -0.20380399  0.4162136 -0.03812772  0.4302551 -0.2714796\nzn      -0.20380399  1.00000000 -0.5157288 -0.06305946 -0.4939129  0.3081860\nindus    0.41621361 -0.51572875  1.0000000  0.10056213  0.7479226 -0.4003754\nchas    -0.03812772 -0.06305946  0.1005621  1.00000000  0.1343054  0.1089458\nnox      0.43025515 -0.49391291  0.7479226  0.13430543  1.0000000 -0.2985734\nrm      -0.27147956  0.30818597 -0.4003754  0.10894581 -0.2985734  1.0000000\nage      0.36909565 -0.54821374  0.6322492  0.12274044  0.7284238 -0.2289946\ndis     -0.39321461  0.63415259 -0.6947256 -0.12528430 -0.7719572  0.2084663\nrad      0.64696715 -0.30489512  0.5896919  0.03172708  0.5972174 -0.1993921\ntax      0.59798322 -0.30187831  0.7241622  0.01282467  0.6523573 -0.2887654\nptratio  0.29566716 -0.40686477  0.4115083 -0.11386661  0.1780921 -0.3499417\nblack   -0.46013904  0.17992670 -0.3620662  0.03803471 -0.3841099  0.1170901\nlstat    0.49320024 -0.40737515  0.6334129 -0.06285083  0.6190130 -0.6451562\nmedv    -0.39920003  0.35760346 -0.5085800  0.19046609 -0.4279134  0.7446525\n               age        dis         rad         tax    ptratio       black\ncrim     0.3690957 -0.3932146  0.64696715  0.59798322  0.2956672 -0.46013904\nzn      -0.5482137  0.6341526 -0.30489512 -0.30187831 -0.4068648  0.17992670\nindus    0.6322492 -0.6947256  0.58969192  0.72416222  0.4115083 -0.36206624\nchas     0.1227404 -0.1252843  0.03172708  0.01282467 -0.1138666  0.03803471\nnox      0.7284238 -0.7719572  0.59721742  0.65235734  0.1780921 -0.38410993\nrm      -0.2289946  0.2084663 -0.19939215 -0.28876544 -0.3499417  0.11709007\nage      1.0000000 -0.7424728  0.45398894  0.50603231  0.2768459 -0.27710759\ndis     -0.7424728  1.0000000 -0.49285054 -0.54411798 -0.2364373  0.30536834\nrad      0.4539889 -0.4928505  1.00000000  0.90461543  0.4605293 -0.48384718\ntax      0.5060323 -0.5441180  0.90461543  1.00000000  0.4696403 -0.46951995\nptratio  0.2768459 -0.2364373  0.46052925  0.46964032  1.0000000 -0.20009421\nblack   -0.2771076  0.3053683 -0.48384718 -0.46951995 -0.2000942  1.00000000\nlstat    0.6081642 -0.5286137  0.50926890  0.57240253  0.3730392 -0.38681452\nmedv    -0.3824431  0.2672528 -0.37979747 -0.47119268 -0.5093652  0.35788326\n              lstat       medv\ncrim     0.49320024 -0.3992000\nzn      -0.40737515  0.3576035\nindus    0.63341291 -0.5085800\nchas    -0.06285083  0.1904661\nnox      0.61901304 -0.4279134\nrm      -0.64515619  0.7446525\nage      0.60816420 -0.3824431\ndis     -0.52861367  0.2672528\nrad      0.50926890 -0.3797975\ntax      0.57240253 -0.4711927\nptratio  0.37303920 -0.5093652\nblack   -0.38681452  0.3578833\nlstat    1.00000000 -0.7333875\nmedv    -0.73338754  1.0000000\n```\n\n\n:::\n:::\n\n\n## Métodos de seleção de modelo\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Best Subset sem definir o número máx de subsets a ser avaliado\najusreg.comp <- regsubsets(medv ~ ., data=conj_treino)\nsummary(ajusreg.comp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSubset selection object\nCall: regsubsets.formula(medv ~ ., data = conj_treino)\n13 Variables  (and intercept)\n        Forced in Forced out\ncrim        FALSE      FALSE\nzn          FALSE      FALSE\nindus       FALSE      FALSE\nchas        FALSE      FALSE\nnox         FALSE      FALSE\nrm          FALSE      FALSE\nage         FALSE      FALSE\ndis         FALSE      FALSE\nrad         FALSE      FALSE\ntax         FALSE      FALSE\nptratio     FALSE      FALSE\nblack       FALSE      FALSE\nlstat       FALSE      FALSE\n1 subsets of each size up to 8\nSelection Algorithm: exhaustive\n         crim zn  indus chas nox rm  age dis rad tax ptratio black lstat\n1  ( 1 ) \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \" \" \" \" \" \" \" \"     \" \"   \" \"  \n2  ( 1 ) \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \" \" \" \" \" \" \" \"     \" \"   \"*\"  \n3  ( 1 ) \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \" \" \" \" \" \" \"*\"     \" \"   \"*\"  \n4  ( 1 ) \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \" \" \" \" \" \" \"*\"     \"*\"   \"*\"  \n5  ( 1 ) \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \"*\" \" \" \" \" \"*\"     \"*\"   \"*\"  \n6  ( 1 ) \" \"  \" \" \" \"   \" \"  \"*\" \"*\" \" \" \"*\" \" \" \" \" \"*\"     \"*\"   \"*\"  \n7  ( 1 ) \" \"  \" \" \" \"   \"*\"  \"*\" \"*\" \" \" \"*\" \" \" \" \" \"*\"     \"*\"   \"*\"  \n8  ( 1 ) \" \"  \" \" \" \"   \"*\"  \"*\" \"*\" \" \" \"*\" \"*\" \" \" \"*\"     \"*\"   \"*\"  \n```\n\n\n:::\n\n```{.r .cell-code}\n## Não testou todas as combinações possíveis\n```\n:::\n\n\n## nvmax=13\n\n\n::: {.cell}\n\n```{.r .cell-code}\najusreg.comp <- regsubsets(medv ~ ., data=conj_treino, nvmax=13)\nsumario.reg <- summary(ajusreg.comp)\nsumario.reg\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSubset selection object\nCall: regsubsets.formula(medv ~ ., data = conj_treino, nvmax = 13)\n13 Variables  (and intercept)\n        Forced in Forced out\ncrim        FALSE      FALSE\nzn          FALSE      FALSE\nindus       FALSE      FALSE\nchas        FALSE      FALSE\nnox         FALSE      FALSE\nrm          FALSE      FALSE\nage         FALSE      FALSE\ndis         FALSE      FALSE\nrad         FALSE      FALSE\ntax         FALSE      FALSE\nptratio     FALSE      FALSE\nblack       FALSE      FALSE\nlstat       FALSE      FALSE\n1 subsets of each size up to 13\nSelection Algorithm: exhaustive\n          crim zn  indus chas nox rm  age dis rad tax ptratio black lstat\n1  ( 1 )  \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \" \" \" \" \" \" \" \"     \" \"   \" \"  \n2  ( 1 )  \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \" \" \" \" \" \" \" \"     \" \"   \"*\"  \n3  ( 1 )  \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \" \" \" \" \" \" \"*\"     \" \"   \"*\"  \n4  ( 1 )  \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \" \" \" \" \" \" \"*\"     \"*\"   \"*\"  \n5  ( 1 )  \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \"*\" \" \" \" \" \"*\"     \"*\"   \"*\"  \n6  ( 1 )  \" \"  \" \" \" \"   \" \"  \"*\" \"*\" \" \" \"*\" \" \" \" \" \"*\"     \"*\"   \"*\"  \n7  ( 1 )  \" \"  \" \" \" \"   \"*\"  \"*\" \"*\" \" \" \"*\" \" \" \" \" \"*\"     \"*\"   \"*\"  \n8  ( 1 )  \" \"  \" \" \" \"   \"*\"  \"*\" \"*\" \" \" \"*\" \"*\" \" \" \"*\"     \"*\"   \"*\"  \n9  ( 1 )  \" \"  \" \" \" \"   \"*\"  \"*\" \"*\" \" \" \"*\" \"*\" \"*\" \"*\"     \"*\"   \"*\"  \n10  ( 1 ) \" \"  \"*\" \" \"   \"*\"  \"*\" \"*\" \" \" \"*\" \"*\" \"*\" \"*\"     \"*\"   \"*\"  \n11  ( 1 ) \"*\"  \"*\" \" \"   \"*\"  \"*\" \"*\" \" \" \"*\" \"*\" \"*\" \"*\"     \"*\"   \"*\"  \n12  ( 1 ) \"*\"  \"*\" \" \"   \"*\"  \"*\" \"*\" \"*\" \"*\" \"*\" \"*\" \"*\"     \"*\"   \"*\"  \n13  ( 1 ) \"*\"  \"*\" \"*\"   \"*\"  \"*\" \"*\" \"*\" \"*\" \"*\" \"*\" \"*\"     \"*\"   \"*\"  \n```\n\n\n:::\n\n```{.r .cell-code}\nnames(sumario.reg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"which\"  \"rsq\"    \"rss\"    \"adjr2\"  \"cp\"     \"bic\"    \"outmat\" \"obj\"   \n```\n\n\n:::\n:::\n\n\n## Avaliando os modelos\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Os modelos vão ser escolhidos com base no menor Cp\nplot(sumario.reg$cp,xlab=\"Número de Variáveis\",ylab=\"Cp\")\nwhich.min(sumario.reg$cp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 11\n```\n\n\n:::\n\n```{.r .cell-code}\npoints(11,sumario.reg$cp[11],pch=20,col=\"red\")\n```\n\n::: {.cell-output-display}\n![](Aula07.3_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n## Como extrair detalhes do ajuste\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoef(ajusreg.comp,11)  \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n (Intercept)         crim           zn         chas          nox           rm \n 24.11955557  -0.05912124   0.03395127   3.45970324 -17.22861717   5.10891588 \n         dis          rad          tax      ptratio        black        lstat \n -1.27274817   0.25203587  -0.01015538  -0.94732891   0.01296186  -0.39603435 \n```\n\n\n:::\n:::\n\n\n## Forward Stepwise (passo a passo à frente)\n\n\n::: {.cell}\n\n```{.r .cell-code}\najusreg.fwd <- regsubsets(medv ~ . , data=conj_treino,nvmax=13, method=\"forward\")\nsumario.reg.fwd <- summary(ajusreg.fwd)\nsumario.reg.fwd \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSubset selection object\nCall: regsubsets.formula(medv ~ ., data = conj_treino, nvmax = 13, \n    method = \"forward\")\n13 Variables  (and intercept)\n        Forced in Forced out\ncrim        FALSE      FALSE\nzn          FALSE      FALSE\nindus       FALSE      FALSE\nchas        FALSE      FALSE\nnox         FALSE      FALSE\nrm          FALSE      FALSE\nage         FALSE      FALSE\ndis         FALSE      FALSE\nrad         FALSE      FALSE\ntax         FALSE      FALSE\nptratio     FALSE      FALSE\nblack       FALSE      FALSE\nlstat       FALSE      FALSE\n1 subsets of each size up to 13\nSelection Algorithm: forward\n          crim zn  indus chas nox rm  age dis rad tax ptratio black lstat\n1  ( 1 )  \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \" \" \" \" \" \" \" \"     \" \"   \" \"  \n2  ( 1 )  \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \" \" \" \" \" \" \" \"     \" \"   \"*\"  \n3  ( 1 )  \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \" \" \" \" \" \" \"*\"     \" \"   \"*\"  \n4  ( 1 )  \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \" \" \" \" \" \" \"*\"     \"*\"   \"*\"  \n5  ( 1 )  \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \"*\" \" \" \" \" \"*\"     \"*\"   \"*\"  \n6  ( 1 )  \" \"  \" \" \" \"   \" \"  \"*\" \"*\" \" \" \"*\" \" \" \" \" \"*\"     \"*\"   \"*\"  \n7  ( 1 )  \" \"  \" \" \" \"   \"*\"  \"*\" \"*\" \" \" \"*\" \" \" \" \" \"*\"     \"*\"   \"*\"  \n8  ( 1 )  \" \"  \" \" \" \"   \"*\"  \"*\" \"*\" \" \" \"*\" \"*\" \" \" \"*\"     \"*\"   \"*\"  \n9  ( 1 )  \" \"  \" \" \" \"   \"*\"  \"*\" \"*\" \" \" \"*\" \"*\" \"*\" \"*\"     \"*\"   \"*\"  \n10  ( 1 ) \" \"  \"*\" \" \"   \"*\"  \"*\" \"*\" \" \" \"*\" \"*\" \"*\" \"*\"     \"*\"   \"*\"  \n11  ( 1 ) \"*\"  \"*\" \" \"   \"*\"  \"*\" \"*\" \" \" \"*\" \"*\" \"*\" \"*\"     \"*\"   \"*\"  \n12  ( 1 ) \"*\"  \"*\" \" \"   \"*\"  \"*\" \"*\" \"*\" \"*\" \"*\" \"*\" \"*\"     \"*\"   \"*\"  \n13  ( 1 ) \"*\"  \"*\" \"*\"   \"*\"  \"*\" \"*\" \"*\" \"*\" \"*\" \"*\" \"*\"     \"*\"   \"*\"  \n```\n\n\n:::\n\n```{.r .cell-code}\nwhich.min(sumario.reg.fwd$cp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 11\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(sumario.reg.fwd$cp,xlab=\"Número de Variáveis\",ylab=\"Cp\")\npoints(11,sumario.reg.fwd$cp[11],pch=20,col=\"red\")\n```\n\n::: {.cell-output-display}\n![](Aula07.3_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n## Como extrair detalhes do ajuste\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoef(ajusreg.fwd,11)  \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n (Intercept)         crim           zn         chas          nox           rm \n 24.11955557  -0.05912124   0.03395127   3.45970324 -17.22861717   5.10891588 \n         dis          rad          tax      ptratio        black        lstat \n -1.27274817   0.25203587  -0.01015538  -0.94732891   0.01296186  -0.39603435 \n```\n\n\n:::\n:::\n\n\n## Backward Stepwise (passo a passo atrás)\n\n\n::: {.cell}\n\n```{.r .cell-code}\najusreg.bwd <- regsubsets(medv ~ . , data=conj_treino,nvmax=13, method=\"backward\")\nsumario.reg.bwd <- summary(ajusreg.bwd)\nsumario.reg.bwd\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSubset selection object\nCall: regsubsets.formula(medv ~ ., data = conj_treino, nvmax = 13, \n    method = \"backward\")\n13 Variables  (and intercept)\n        Forced in Forced out\ncrim        FALSE      FALSE\nzn          FALSE      FALSE\nindus       FALSE      FALSE\nchas        FALSE      FALSE\nnox         FALSE      FALSE\nrm          FALSE      FALSE\nage         FALSE      FALSE\ndis         FALSE      FALSE\nrad         FALSE      FALSE\ntax         FALSE      FALSE\nptratio     FALSE      FALSE\nblack       FALSE      FALSE\nlstat       FALSE      FALSE\n1 subsets of each size up to 13\nSelection Algorithm: backward\n          crim zn  indus chas nox rm  age dis rad tax ptratio black lstat\n1  ( 1 )  \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \" \" \" \" \" \" \" \"     \" \"   \" \"  \n2  ( 1 )  \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \" \" \" \" \" \" \" \"     \" \"   \"*\"  \n3  ( 1 )  \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \" \" \" \" \" \" \"*\"     \" \"   \"*\"  \n4  ( 1 )  \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \" \" \" \" \" \" \"*\"     \"*\"   \"*\"  \n5  ( 1 )  \" \"  \" \" \" \"   \" \"  \" \" \"*\" \" \" \"*\" \" \" \" \" \"*\"     \"*\"   \"*\"  \n6  ( 1 )  \" \"  \" \" \" \"   \" \"  \"*\" \"*\" \" \" \"*\" \" \" \" \" \"*\"     \"*\"   \"*\"  \n7  ( 1 )  \" \"  \" \" \" \"   \"*\"  \"*\" \"*\" \" \" \"*\" \" \" \" \" \"*\"     \"*\"   \"*\"  \n8  ( 1 )  \" \"  \" \" \" \"   \"*\"  \"*\" \"*\" \" \" \"*\" \"*\" \" \" \"*\"     \"*\"   \"*\"  \n9  ( 1 )  \" \"  \" \" \" \"   \"*\"  \"*\" \"*\" \" \" \"*\" \"*\" \"*\" \"*\"     \"*\"   \"*\"  \n10  ( 1 ) \" \"  \"*\" \" \"   \"*\"  \"*\" \"*\" \" \" \"*\" \"*\" \"*\" \"*\"     \"*\"   \"*\"  \n11  ( 1 ) \"*\"  \"*\" \" \"   \"*\"  \"*\" \"*\" \" \" \"*\" \"*\" \"*\" \"*\"     \"*\"   \"*\"  \n12  ( 1 ) \"*\"  \"*\" \" \"   \"*\"  \"*\" \"*\" \"*\" \"*\" \"*\" \"*\" \"*\"     \"*\"   \"*\"  \n13  ( 1 ) \"*\"  \"*\" \"*\"   \"*\"  \"*\" \"*\" \"*\" \"*\" \"*\" \"*\" \"*\"     \"*\"   \"*\"  \n```\n\n\n:::\n\n```{.r .cell-code}\nwhich.min(sumario.reg.bwd$cp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 11\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(sumario.reg.bwd$cp,xlab=\"Número de Variáveis\",ylab=\"Cp\")\npoints(11,sumario.reg.bwd$cp[11],pch=20,col=\"red\")\n```\n\n::: {.cell-output-display}\n![](Aula07.3_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n## Como extrair detalhes do ajuste\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoef(ajusreg.bwd,11)  \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n (Intercept)         crim           zn         chas          nox           rm \n 24.11955557  -0.05912124   0.03395127   3.45970324 -17.22861717   5.10891588 \n         dis          rad          tax      ptratio        black        lstat \n -1.27274817   0.25203587  -0.01015538  -0.94732891   0.01296186  -0.39603435 \n```\n\n\n:::\n:::\n\n\n## Comportamento dos erros de treino e teste\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Codigo original de T. Hastie\nreg.fwd <- regsubsets(medv ~ . ,data=conj_treino,nvmax=13, method=\"forward\")\nval.erro <- rep(NA,13)\nx.teste <- model.matrix(medv~.,data=conj_teste)\nfor(i in 1:13){\n  coefi <- coef(reg.fwd,id=i)\n  pred <- x.teste[,names(coefi)]%*%coefi\n  val.erro[i] <- mean((conj_teste$medv - pred)^2)\n}\nplot(sqrt(val.erro),ylab=\"Raiz do EQM\",ylim=c(4,8),pch=19,type=\"b\")\npoints(sqrt(reg.fwd$rss[-1]/403),col=\"blue\",pch=19,type=\"b\")\nlegend(\"topright\",legend=c(\"Treino\",\"Teste\"),col=c(\"blue\",\"black\"),pch=19)\n```\n\n::: {.cell-output-display}\n![](Aula07.3_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n## Testando outra estatística de seleção de modelos - BIC\n\n\n::: {.cell}\n\n```{.r .cell-code}\najusreg.fwd1 <- regsubsets(medv ~ . , data=conj_treino,nvmax=13, method=\"forward\")\nsumario.reg.fwd1 <- summary(ajusreg.fwd1)\nnames(sumario.reg.fwd1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"which\"  \"rsq\"    \"rss\"    \"adjr2\"  \"cp\"     \"bic\"    \"outmat\" \"obj\"   \n```\n\n\n:::\n\n```{.r .cell-code}\nwhich.min(sumario.reg.fwd1$bic)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 7\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(sumario.reg.fwd1$bic,xlab=\"Número de Variáveis\",ylab=\"BIC\")\npoints(7,sumario.reg.fwd1$bic[7],pch=20,col=\"red\")\n```\n\n::: {.cell-output-display}\n![](Aula07.3_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncoef(ajusreg.fwd1,7)  \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n (Intercept)         chas          nox           rm          dis      ptratio \n 18.15699005   3.62527238 -16.32477597   5.61737907  -1.00175093  -0.95906300 \n       black        lstat \n  0.01229926  -0.39019735 \n```\n\n\n:::\n:::\n\n\n## Usando o Cp novamente\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwhich.min(sumario.reg.fwd1$cp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 11\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(sumario.reg.fwd1$cp,xlab=\"Número de Variáveis\",ylab=\"Cp\")\npoints(11,sumario.reg.fwd1$cp[11],pch=20,col=\"red\")\n```\n\n::: {.cell-output-display}\n![](Aula07.3_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncoef(ajusreg.fwd1,11)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n (Intercept)         crim           zn         chas          nox           rm \n 24.11955557  -0.05912124   0.03395127   3.45970324 -17.22861717   5.10891588 \n         dis          rad          tax      ptratio        black        lstat \n -1.27274817   0.25203587  -0.01015538  -0.94732891   0.01296186  -0.39603435 \n```\n\n\n:::\n:::\n\n\n## Comparando os dois modelos com o lm()\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Usando o lm para ajustar o modelo com as variáveis selecionadas pelo BIC\nmod_bic <- lm(medv ~ chas + nox + rm + dis + ptratio + black + lstat, data=conj_treino) \nsummary(mod_bic)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = medv ~ chas + nox + rm + dis + ptratio + black + \n    lstat, data = conj_treino)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-18.4971  -2.7789  -0.5478   1.7933  26.9857 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  18.156990   5.385606   3.371 0.000822 ***\nchas          3.625272   1.009714   3.590 0.000372 ***\nnox         -16.324776   3.534591  -4.619 5.24e-06 ***\nrm            5.617379   0.457084  12.290  < 2e-16 ***\ndis          -1.001751   0.180856  -5.539 5.56e-08 ***\nptratio      -0.959063   0.119626  -8.017 1.24e-14 ***\nblack         0.012299   0.002702   4.552 7.07e-06 ***\nlstat        -0.390197   0.053934  -7.235 2.44e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.631 on 395 degrees of freedom\nMultiple R-squared:  0.7512,\tAdjusted R-squared:  0.7468 \nF-statistic: 170.4 on 7 and 395 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nmod_cp <- lm(medv ~ crim + zn + chas + nox + rm + dis + rad + tax + ptratio + black + lstat, data=conj_treino)\nsummary(mod_cp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = medv ~ crim + zn + chas + nox + rm + dis + rad + \n    tax + ptratio + black + lstat, data = conj_treino)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-18.1857  -2.8830  -0.5641   1.8709  25.9074 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  24.119556   5.661887   4.260 2.56e-05 ***\ncrim         -0.059121   0.038751  -1.526 0.127902    \nzn            0.033951   0.015207   2.233 0.026139 *  \nchas          3.459703   0.995635   3.475 0.000568 ***\nnox         -17.228617   3.807289  -4.525 8.02e-06 ***\nrm            5.108916   0.466926  10.942  < 2e-16 ***\ndis          -1.272748   0.203301  -6.260 1.01e-09 ***\nrad           0.252036   0.067390   3.740 0.000212 ***\ntax          -0.010155   0.003556  -2.856 0.004525 ** \nptratio      -0.947329   0.141436  -6.698 7.38e-11 ***\nblack         0.012962   0.002822   4.593 5.90e-06 ***\nlstat        -0.396034   0.054069  -7.325 1.38e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.554 on 391 degrees of freedom\nMultiple R-squared:  0.7618,\tAdjusted R-squared:  0.7551 \nF-statistic: 113.7 on 11 and 391 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n## Eliminando a variável não significativa\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_cp2 <- lm(medv ~ zn + chas + nox + rm + dis + rad + tax + ptratio + black + lstat, data=conj_treino)\nsummary(mod_cp2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = medv ~ zn + chas + nox + rm + dis + rad + tax + \n    ptratio + black + lstat, data = conj_treino)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-18.1471  -2.7317  -0.5389   1.9772  25.9698 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  22.884672   5.613214   4.077 5.53e-05 ***\nzn            0.031594   0.015154   2.085 0.037726 *  \nchas          3.524816   0.996402   3.538 0.000452 ***\nnox         -16.721605   3.799175  -4.401 1.39e-05 ***\nrm            5.183515   0.465145  11.144  < 2e-16 ***\ndis          -1.231499   0.201836  -6.101 2.52e-09 ***\nrad           0.218320   0.063772   3.423 0.000683 ***\ntax          -0.009827   0.003556  -2.764 0.005984 ** \nptratio      -0.938621   0.141560  -6.631 1.11e-10 ***\nblack         0.013799   0.002773   4.976 9.72e-07 ***\nlstat        -0.406190   0.053749  -7.557 2.94e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.562 on 392 degrees of freedom\nMultiple R-squared:  0.7604,\tAdjusted R-squared:  0.7543 \nF-statistic: 124.4 on 10 and 392 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n## Avaliando Colinearidade\n\nUma investigação minuciosa da multicollinearidade envolverá a análise do valor do $R^2$ que resulta da regressão de cada uma das variáveis explicativas contra todas as outras. A relação entre as variáveis explicativas pode ser julgada examinando uma quantidade chamada fator de inflacionário da variância (FIV) ou Variance Inflation Factor (VIF). Seja $Rj~^{2}$ o quadrado do coeficiente de correlação múltipla que resulta quando a variável explicativa $Xj~$ é ajustada contra todas as outras variáveis explicativas. Então o vif para $Xj~$ é $VIFj = 1 / (1-Rj~^{2})$\n\n**A regra geral é que vifs superiores a 4 justificam novas investigações, enquanto VIFs superiores a 10 são sinais de multicollinearidade grave que requerem correção.**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCarregando pacotes exigidos: carData\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'car'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:dplyr':\n\n    recode\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:purrr':\n\n    some\n```\n\n\n:::\n\n```{.r .cell-code}\nvif(mod_cp2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      zn     chas      nox       rm      dis      rad      tax  ptratio \n2.128862 1.076888 3.707463 2.032934 3.357506 6.005229 6.999822 1.796214 \n   black    lstat \n1.388299 3.010108 \n```\n\n\n:::\n\n```{.r .cell-code}\n## Vamos eliminar tax e ver o que acontece\nmod_cp3 <- lm(medv ~ zn + chas + nox + rm + dis + rad + ptratio + black + lstat, data=conj_treino)\nsummary(mod_cp3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = medv ~ zn + chas + nox + rm + dis + rad + ptratio + \n    black + lstat, data = conj_treino)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-18.6480  -2.9158  -0.5013   1.9274  25.8537 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  21.606433   5.641174   3.830 0.000149 ***\nzn            0.021779   0.014856   1.466 0.143439    \nchas          3.623029   1.004143   3.608 0.000348 ***\nnox         -18.864099   3.750520  -5.030 7.48e-07 ***\nrm            5.337321   0.465687  11.461  < 2e-16 ***\ndis          -1.150869   0.201396  -5.714 2.18e-08 ***\nrad           0.079897   0.039806   2.007 0.045417 *  \nptratio      -1.016641   0.139883  -7.268 1.99e-12 ***\nblack         0.014071   0.002794   5.035 7.28e-07 ***\nlstat        -0.411503   0.054166  -7.597 2.24e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.6 on 393 degrees of freedom\nMultiple R-squared:  0.7557,\tAdjusted R-squared:  0.7501 \nF-statistic: 135.1 on 9 and 393 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nvif(mod_cp3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      zn     chas      nox       rm      dis      rad  ptratio    black \n2.011936 1.075519 3.553096 2.003832 3.287355 2.300918 1.724780 1.386548 \n   lstat \n3.006257 \n```\n\n\n:::\n:::\n\n\n## Testando os dois modelos com o conjunto de teste\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modelo com base no Cp\nsummary(mod_cp3)$sigma\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4.600016\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(mod_cp3)$adj.r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.7501409\n```\n\n\n:::\n\n```{.r .cell-code}\nsqrt(mean((conj_teste$medv - predict(mod_cp3, conj_teste)) ^ 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 5.918251\n```\n\n\n:::\n\n```{.r .cell-code}\n# Modelo com base no BIC\nmod_bic <- lm(medv ~ chas + nox + rm + dis + ptratio + black + lstat, data=conj_treino) \nsummary(mod_bic)$sigma\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4.630994\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(mod_bic)$adj.r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.7467643\n```\n\n\n:::\n\n```{.r .cell-code}\nsqrt(mean((conj_teste$medv - predict(mod_bic, conj_teste)) ^ 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 6.023672\n```\n\n\n:::\n:::\n",
    "supporting": [
      "Aula07.3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}