{
  "hash": "c29796a4e8b68cc6b957757d3ccd3e0f",
  "result": {
    "markdown": "---\ntitle: \"Carregando dados, Manipulando e Visualizando\"\nauthor: \"Ricardo Accioly\"\ndate: ' 2023-05-25 '\nformat:\n html:\n    code-link: true\n---\n\n\n\n\n## Entrada de dados no R\n\n## Lendo dados de arquivos csv\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr)\nurl <- \"https://www.gov.br/anp/pt-br/centrais-de-conteudo/dados-abertos/arquivos-acervo-de-dados-tecnicos/tabela-pocos.csv\"\n## O read_delim permite que seja definido o tipo de delimitador dos dados\npocos <- read_delim(url, delim = \";\", locale= locale(decimal_mark = \",\"), col_names = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 30450 Columns: 60\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr (51): POCO, CADASTRO, OPERADOR, POCO_OPERADOR, ESTADO, BACIA, BLOCO, SIG...\ndbl  (8): LATITUDE_BASE_DD, LONGITUDE_BASE_DD, PROFUNDIDADE_VERTICAL_M, PROF...\nlgl  (1): UNIDADE_ESTRATIGRAFICA\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nhead(pocos)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 60\n  POCO      CADASTRO   OPERADOR POCO_OPERADOR ESTADO BACIA BLOCO SIG_CAMPO CAMPO\n  <chr>     <chr>      <chr>    <chr>         <chr>  <chr> <chr> <chr>     <chr>\n1 7-L-10-BA 202400001… <NA>     7L   0010  BA BA     Recô… <NA>  \"L    \"   LOBA…\n2 1-AL-3-AL 081150000… <NA>     1AL  0003  AL AL     Alag… Bras…  <NA>     <NA> \n3 3-L-11-BA 202400001… <NA>     3L   0011  BA BA     Recô… <NA>  \"L    \"   LOBA…\n4 1-C-1-BA  202400001… 3R Cand… 1C   0001  BA BA     Recô… C     \"C    \"   CAND…\n5 7-L-12-BA 202400001… <NA>     7L   0012  BA BA     Recô… <NA>  \"L    \"   LOBA…\n6 1-AL-5-AL 081150000… <NA>     1AL  0005  AL AL     Alag… Bras…  <NA>     <NA> \n# ℹ 51 more variables: TERRA_MAR <chr>, POCO_POS_ANP <chr>, TIPO <chr>,\n#   CATEGORIA <chr>, RECLASSIFICACAO <chr>, SITUACAO <chr>, INICIO <chr>,\n#   TERMINO <chr>, CONCLUSAO <chr>, TITULARIDADE <chr>, LATITUDE_BASE_4C <chr>,\n#   LONGITUDE_BASE_4C <chr>, LATITUDE_BASE_DD <dbl>, LONGITUDE_BASE_DD <dbl>,\n#   DATUM_HORIZONTAL <chr>, TIPO_DE_COORDENADA_DE_BASE <chr>, DIRECAO <chr>,\n#   PROFUNDIDADE_VERTICAL_M <dbl>, PROFUNDIDADE_SONDADOR_M <dbl>,\n#   PROFUNDIDADE_MEDIDA_M <dbl>, REFERENCIA_DE_PROFUNDIDADE <chr>, …\n```\n:::\n:::\n\n\n## Bibliotecas\n\nVamos carregar as bibliotecas que serão usadas na manipulação e visualização de dados.\n\nO pacote tidyverse carrega diversos pacotes muito uteis na manipulação e visualização de dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"tidyverse\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.1     ✔ purrr     1.0.1\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n:::\n\n\nVamos primeiro conhecer o que tem na base de dados pocos. A base de dados possui 30450 linhas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(pocos)  # Tipo de base de dados\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"spec_tbl_df\" \"tbl_df\"      \"tbl\"         \"data.frame\" \n```\n:::\n\n```{.r .cell-code}\nsummary(pocos) # Sumario da base de dados\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     POCO             CADASTRO           OPERADOR         POCO_OPERADOR     \n Length:30450       Length:30450       Length:30450       Length:30450      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n    ESTADO             BACIA              BLOCO            SIG_CAMPO        \n Length:30450       Length:30450       Length:30450       Length:30450      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n    CAMPO            TERRA_MAR         POCO_POS_ANP           TIPO          \n Length:30450       Length:30450       Length:30450       Length:30450      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n  CATEGORIA         RECLASSIFICACAO      SITUACAO            INICIO         \n Length:30450       Length:30450       Length:30450       Length:30450      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n   TERMINO           CONCLUSAO         TITULARIDADE       LATITUDE_BASE_4C  \n Length:30450       Length:30450       Length:30450       Length:30450      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n LONGITUDE_BASE_4C  LATITUDE_BASE_DD  LONGITUDE_BASE_DD DATUM_HORIZONTAL  \n Length:30450       Min.   :-32.927   Min.   :-73.38    Length:30450      \n Class :character   1st Qu.:-12.694   1st Qu.:-39.65    Class :character  \n Mode  :character   Median :-10.710   Median :-37.83    Mode  :character  \n                    Mean   :-11.497   Mean   :-38.84                      \n                    3rd Qu.: -5.328   3rd Qu.:-36.98                      \n                    Max.   :  4.528   Max.   :-34.83                      \n                                                                          \n TIPO_DE_COORDENADA_DE_BASE   DIRECAO          PROFUNDIDADE_VERTICAL_M\n Length:30450               Length:30450       Min.   :-59053.0       \n Class :character           Class :character   1st Qu.:  -645.5       \n Mode  :character           Mode  :character   Median :     0.0       \n                                               Mean   :  -226.8       \n                                               3rd Qu.:     0.0       \n                                               Max.   :528084.0       \n                                               NA's   :18248          \n PROFUNDIDADE_SONDADOR_M PROFUNDIDADE_MEDIDA_M REFERENCIA_DE_PROFUNDIDADE\n Min.   :    0           Min.   :    0         Length:30450              \n 1st Qu.:  482           1st Qu.:  269         Class :character          \n Median :  994           Median :  795         Mode  :character          \n Mean   : 1501           Mean   : 1459                                   \n 3rd Qu.: 2230           3rd Qu.: 2334                                   \n Max.   :29170           Max.   :29185                                   \n NA's   :948             NA's   :16728                                   \n MESA_ROTATIVA     COTA_ALTIMETRICA_M LAMINA_D_AGUA_M  DATUM_VERTICAL    \n Min.   :   0.00   Min.   :   0.00    Min.   :   0.0   Length:30450      \n 1st Qu.:  19.00   1st Qu.:   0.00    1st Qu.:   0.0   Class :character  \n Median :  32.40   Median :   7.70    Median :   0.0   Mode  :character  \n Mean   :  57.13   Mean   :  35.99    Mean   : 274.9                     \n 3rd Qu.:  75.55   3rd Qu.:  52.40    3rd Qu.: 109.0                     \n Max.   :1600.00   Max.   :6672.00    Max.   :3094.0                     \n                   NA's   :16199      NA's   :14172                      \n UNIDADE_ESTRATIGRAFICA GEOLOGIA_GRUPO_FINAL GEOLOGIA_FORMACAO_FINAL\n Mode:logical           Length:30450         Length:30450           \n NA's:30450             Class :character     Class :character       \n                        Mode  :character     Mode  :character       \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n GEOLOGIA_MEMBRO_FINAL     CDPE               AGP                 PC           \n Length:30450          Length:30450       Length:30450       Length:30450      \n Class :character      Class :character   Class :character   Class :character  \n Mode  :character      Mode  :character   Mode  :character   Mode  :character  \n                                                                               \n                                                                               \n                                                                               \n                                                                               \n     PAG            PERFIS_CONVENCIONAIS DURANTE_PERFURACAO PERFIS_DIGITAIS   \n Length:30450       Length:30450         Length:30450       Length:30450      \n Class :character   Class :character     Class :character   Class :character  \n Mode  :character   Mode  :character     Mode  :character   Mode  :character  \n                                                                              \n                                                                              \n                                                                              \n                                                                              \n PERFIS_PROCESSADOS PERFIS_ESPECIAIS   AMOSTRA_LATERAL      SISMICA         \n Length:30450       Length:30450       Length:30450       Length:30450      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n TABELA_TEMPO_PROFUNDIDADE DADOS_DIRECIONAIS  TESTE_A_CABO      \n Length:30450              Length:30450       Length:30450      \n Class :character          Class :character   Class :character  \n Mode  :character          Mode  :character   Mode  :character  \n                                                                \n                                                                \n                                                                \n                                                                \n TESTE_DE_FORMACAO   CANHONEIO          TESTEMUNHO         GEOQUIMICA       \n Length:30450       Length:30450       Length:30450       Length:30450      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n  SIG_SONDA          NOM_SONDA         ATINGIU_PRESAL     DHA_ATUALIZACAO   \n Length:30450       Length:30450       Length:30450       Length:30450      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n```\n:::\n:::\n\n\n## Dados de poços\n\nOs dados da tabela poços tem 60 colunas.\n\nVamos inicialmente selecionar algumas colunas para podermos trabalhar com os dados.\n\n**As colunas que vamos trabalhar são:**\n\n1)  POCO\n2)  OPERADOR\n3)  ESTADO\n4)  BACIA\n5)  BLOCO\n6)  CAMPO\n7)  TERRA_MAR\n8)  CATEGORIA\n9)  SITUACAO\n10) INICIO\n11) TERMINO\n12) PROFUNDIDADE_MEDIDA_M\n\nPara selecionar colunas usamos a função `select`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Vamos selecionar as colunas listadas acima\npocos_01 <- pocos %>% select(POCO,OPERADOR,ESTADO,BACIA,BLOCO, CAMPO,TERRA_MAR,CATEGORIA,SITUACAO, INICIO, TERMINO, PROFUNDIDADE_MEDIDA_M)\nhead(pocos_01)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 12\n  POCO     OPERADOR ESTADO BACIA BLOCO CAMPO TERRA_MAR CATEGORIA SITUACAO INICIO\n  <chr>    <chr>    <chr>  <chr> <chr> <chr> <chr>     <chr>     <chr>    <chr> \n1 7-L-10-… <NA>     BA     Recô… <NA>  LOBA… T         Desenvol… ABANDON… 20/12…\n2 1-AL-3-… <NA>     AL     Alag… Bras… <NA>  T         Pioneiro  ARRASADO 26/02…\n3 3-L-11-… <NA>     BA     Recô… <NA>  LOBA… T         Extensão  ABANDON… 09/03…\n4 1-C-1-BA 3R Cand… BA     Recô… C     CAND… T         Pioneiro  PRODUZI… 02/04…\n5 7-L-12-… <NA>     BA     Recô… <NA>  LOBA… T         Desenvol… DEVOLVI… 10/04…\n6 1-AL-5-… <NA>     AL     Alag… Bras… <NA>  T         Pioneiro  ARRASADO 21/08…\n# ℹ 2 more variables: TERMINO <chr>, PROFUNDIDADE_MEDIDA_M <dbl>\n```\n:::\n:::\n\n\n## Manipulação de dados\n\nVamos eliminar as linhas de dados que apresenta dados ausentes \"NA\" nas colunas TERMINO e PROFUNDIDADE_MEDIDA_M.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(is.na(pocos_01))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 29411\n```\n:::\n\n```{.r .cell-code}\nsum(is.na(pocos_01$INICIO))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n\n```{.r .cell-code}\nsum(is.na(pocos_01$TERMINO))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1852\n```\n:::\n\n```{.r .cell-code}\nsum(is.na(pocos_01$PROFUNDIDADE_MEDIDA_M))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 16728\n```\n:::\n\n```{.r .cell-code}\npocos_01 <- pocos_01 %>% drop_na(any_of(c(\"TERMINO\",\n                                          \"PROFUNDIDADE_MEDIDA_M\")))\n# melhorando a visualização dos dados\nknitr::kable(\n  head(pocos_01, 10), booktabs = TRUE,\n  caption = 'Uma tabela mais elegante com as 10 primeras linhas de pocos_01.')\n```\n\n::: {.cell-output-display}\nTable: Uma tabela mais elegante com as 10 primeras linhas de pocos_01.\n\n|POCO        |OPERADOR       |ESTADO |BACIA     |BLOCO |CAMPO            |TERRA_MAR |CATEGORIA       |SITUACAO                   |INICIO           |TERMINO          | PROFUNDIDADE_MEDIDA_M|\n|:-----------|:--------------|:------|:---------|:-----|:----------------|:---------|:---------------|:--------------------------|:----------------|:----------------|---------------------:|\n|1-P-1-BA    |Alcom          |BA     |Recôncavo |P     |NA               |T         |Pioneiro        |DEVOLVIDO                  |25/04/1945 00:00 |15/12/1945 00:00 |                     0|\n|7-I-22-BA   |NTF            |BA     |Recôncavo |I_AM4 |ITAPARICA        |T         |Desenvolvimento |PRODUZINDO                 |10/01/1946 00:00 |26/08/1946 00:00 |                     0|\n|1-P-2-BA    |Alcom          |BA     |Recôncavo |P     |NA               |T         |Pioneiro        |ABANDONADO PERMANENTEMENTE |19/03/1946 00:00 |25/05/1946 00:00 |                     0|\n|2-PST-1-BA  |Alcom          |BA     |Recôncavo |P     |NA               |T         |Estratigráfico  |ABANDONADO PERMANENTEMENTE |17/05/1946 00:00 |14/06/1946 00:00 |                     0|\n|2-PST-2-BA  |Alcom          |BA     |Recôncavo |P     |NA               |T         |Estratigráfico  |ABANDONADO PERMANENTEMENTE |29/06/1946 00:00 |18/07/1946 00:00 |                     0|\n|2-PST-3-BA  |PetroRecôncavo |BA     |Recôncavo |MJ    |MATA DE SÃO JOÃO |T         |Estratigráfico  |ABANDONADO PERMANENTEMENTE |08/08/1946 00:00 |25/08/1946 00:00 |                     0|\n|2-PST-4-BA  |PetroRecôncavo |BA     |Recôncavo |MJ    |MATA DE SÃO JOÃO |T         |Estratigráfico  |ABANDONADO PERMANENTEMENTE |25/09/1946 00:00 |21/10/1946 00:00 |                     0|\n|2-PST-7-BA  |PetroRecôncavo |BA     |Recôncavo |MJ    |MATA DE SÃO JOÃO |T         |Estratigráfico  |ABANDONADO PERMANENTEMENTE |04/02/1947 00:00 |24/02/1947 00:00 |                     0|\n|2-PST-7A-BA |PetroRecôncavo |BA     |Recôncavo |MJ    |MATA DE SÃO JOÃO |T         |Estratigráfico  |ABANDONADO PERMANENTEMENTE |11/02/1947 00:00 |25/03/1947 00:00 |                     0|\n|2-PST-8-BA  |PetroRecôncavo |BA     |Recôncavo |MJ    |MATA DE SÃO JOÃO |T         |Estratigráfico  |ABANDONADO PERMANENTEMENTE |01/04/1947 00:00 |14/04/1947 00:00 |                     0|\n:::\n\n```{.r .cell-code}\nsum(is.na(pocos_01))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4596\n```\n:::\n:::\n\n\n## Corrigindo tipo de dados\n\nAs colunas INICIO e TERMINO são datas, mas foram lidas como caracter, vamos corrigir isto!\n\nPara trabalhar com datas vamos usar o pacote `lubridate`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lubridate)\npocos_01$INICIO <- dmy_hm(pocos_01$INICIO, locale = Sys.getlocale(\"LC_TIME\"))\npocos_01$TERMINO <- dmy_hm(pocos_01$TERMINO, locale = Sys.getlocale(\"LC_TIME\"))\n```\n:::\n\n\n## Filtrando dados\n\nVamos analisar os poços de uma detreminada região, para isto podemos fltrar os poços de um bloco. Vamos filtrar somente os poços do CAMPO PEREGRINO usando a função `filter`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npocos_02 <- pocos_01 %>% filter(CAMPO==\"PEREGRINO\") ##  \nsummary(pocos_02)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     POCO             OPERADOR            ESTADO             BACIA          \n Length:106         Length:106         Length:106         Length:106        \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n    BLOCO              CAMPO            TERRA_MAR          CATEGORIA        \n Length:106         Length:106         Length:106         Length:106        \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n   SITUACAO             INICIO                      \n Length:106         Min.   :1994-07-07 00:00:00.00  \n Class :character   1st Qu.:2012-02-04 18:00:00.00  \n Mode  :character   Median :2014-01-03 00:00:00.00  \n                    Mean   :2014-10-09 08:49:48.68  \n                    3rd Qu.:2017-05-18 00:00:00.00  \n                    Max.   :2022-11-29 00:00:00.00  \n    TERMINO                       PROFUNDIDADE_MEDIDA_M\n Min.   :1994-08-17 00:00:00.00   Min.   :   0         \n 1st Qu.:2012-03-16 00:00:00.00   1st Qu.:4452         \n Median :2014-03-02 00:00:00.00   Median :4924         \n Mean   :2014-11-12 18:33:57.74   Mean   :5045         \n 3rd Qu.:2017-05-26 12:00:00.00   3rd Qu.:6213         \n Max.   :2023-01-05 00:00:00.00   Max.   :8613         \n```\n:::\n\n```{.r .cell-code}\nknitr::kable(\n  head(pocos_02, 10), booktabs = TRUE,\n  caption = 'Uma tabela mais elegante com as 10 primeras linhas de pocos_02.')\n```\n\n::: {.cell-output-display}\nTable: Uma tabela mais elegante com as 10 primeras linhas de pocos_02.\n\n|POCO            |OPERADOR       |ESTADO |BACIA  |BLOCO |CAMPO     |TERRA_MAR |CATEGORIA       |SITUACAO                   |INICIO     |TERMINO    | PROFUNDIDADE_MEDIDA_M|\n|:---------------|:--------------|:------|:------|:-----|:---------|:---------|:---------------|:--------------------------|:----------|:----------|---------------------:|\n|7-PRG-31H-RJS   |Equinor Brasil |RJ     |Campos |NA    |PEREGRINO |M         |Desenvolvimento |PRODUZINDO                 |2013-04-19 |2013-09-28 |               6052.50|\n|7-PRG-27H-RJS   |Equinor Brasil |RJ     |Campos |NA    |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2013-02-01 |2013-03-08 |               5688.40|\n|8-PRG-30DA-RJS  |Equinor Brasil |RJ     |Campos |NA    |PEREGRINO |M         |Injeção         |INJETANDO                  |2013-06-04 |2013-06-21 |               6250.00|\n|7-PRG-40HP-RJS  |Equinor Brasil |RJ     |Campos |NA    |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2014-07-27 |2014-08-03 |               4797.74|\n|8-PRG-36H-RJS   |Equinor Brasil |RJ     |Campos |NA    |PEREGRINO |M         |Injeção         |ABANDONADO PERMANENTEMENTE |2013-12-20 |2014-03-02 |               4456.00|\n|8-PRG-39D-RJS   |Equinor Brasil |RJ     |Campos |NA    |PEREGRINO |M         |Injeção         |INJETANDO                  |2014-07-18 |2014-09-25 |               7075.63|\n|8-PRG-36HA-RJS  |Equinor Brasil |RJ     |Campos |NA    |PEREGRINO |M         |Injeção         |ABANDONADO PERMANENTEMENTE |2014-03-02 |2014-05-10 |               4467.00|\n|8-PRG-38H-RJS   |Equinor Brasil |RJ     |Campos |NA    |PEREGRINO |M         |Injeção         |INJETANDO                  |2014-01-17 |2014-03-02 |               5960.00|\n|7-PRG-35HPA-RJS |Equinor Brasil |RJ     |Campos |NA    |PEREGRINO |M         |Desenvolvimento |PRODUZINDO                 |2013-11-27 |2013-12-04 |               4757.30|\n|7-PRG-35HP-RJS  |Equinor Brasil |RJ     |Campos |NA    |PEREGRINO |M         |Desenvolvimento |ABANDONADO PERMANENTEMENTE |2013-11-15 |2013-11-28 |               3781.00|\n:::\n:::\n\n\n### Avaliando os dados\n\nOs poços possuem diversas categorias, vamos ver que categorias existem nestes poços do bloco BES-100.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(pocos_02$CATEGORIA)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Desenvolvimento\" \"Injeção\"         \"Extensão\"        \"Pioneiro\"       \n[5] \"Especial\"       \n```\n:::\n:::\n\n\n### Filtrando poços de desenvolvimento\n\n\n::: {.cell}\n\n```{.r .cell-code}\npocos_03 <- pocos_02 %>% filter(CATEGORIA==\"Desenvolvimento\") ##  \nsummary(pocos_03)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     POCO             OPERADOR            ESTADO             BACIA          \n Length:83          Length:83          Length:83          Length:83         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n    BLOCO              CAMPO            TERRA_MAR          CATEGORIA        \n Length:83          Length:83          Length:83          Length:83         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n   SITUACAO             INICIO                      \n Length:83          Min.   :2010-11-10 00:00:00.00  \n Class :character   1st Qu.:2012-04-25 12:00:00.00  \n Mode  :character   Median :2014-11-07 00:00:00.00  \n                    Mean   :2015-05-18 18:47:42.65  \n                    3rd Qu.:2017-07-02 00:00:00.00  \n                    Max.   :2022-11-29 00:00:00.00  \n    TERMINO                       PROFUNDIDADE_MEDIDA_M\n Min.   :2010-11-11 00:00:00.00   Min.   : 269         \n 1st Qu.:2012-05-30 00:00:00.00   1st Qu.:4509         \n Median :2014-11-11 00:00:00.00   Median :5066         \n Mean   :2015-06-22 18:47:42.65   Mean   :5284         \n 3rd Qu.:2017-06-24 12:00:00.00   3rd Qu.:6410         \n Max.   :2023-01-05 00:00:00.00   Max.   :8613         \n```\n:::\n\n```{.r .cell-code}\nknitr::kable(\n  head(pocos_03, 10), booktabs = TRUE,\n  caption = 'Uma tabela mais elegante com as 10 primeras linhas de pocos_03.')\n```\n\n::: {.cell-output-display}\nTable: Uma tabela mais elegante com as 10 primeras linhas de pocos_03.\n\n|POCO            |OPERADOR       |ESTADO |BACIA  |BLOCO  |CAMPO     |TERRA_MAR |CATEGORIA       |SITUACAO                   |INICIO     |TERMINO    | PROFUNDIDADE_MEDIDA_M|\n|:---------------|:--------------|:------|:------|:------|:---------|:---------|:---------------|:--------------------------|:----------|:----------|---------------------:|\n|7-PRG-31H-RJS   |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |PRODUZINDO                 |2013-04-19 |2013-09-28 |               6052.50|\n|7-PRG-27H-RJS   |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2013-02-01 |2013-03-08 |               5688.40|\n|7-PRG-40HP-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2014-07-27 |2014-08-03 |               4797.74|\n|7-PRG-35HPA-RJS |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |PRODUZINDO                 |2013-11-27 |2013-12-04 |               4757.30|\n|7-PRG-35HP-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |ABANDONADO PERMANENTEMENTE |2013-11-15 |2013-11-28 |               3781.00|\n|7-PRG-64HP-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |PRODUZINDO                 |2018-11-11 |2018-12-05 |               5790.00|\n|7-PRG-58HB-RJS  |Equinor Brasil |RJ     |Campos |BM-C-7 |PEREGRINO |M         |Desenvolvimento |ABANDONADO PERMANENTEMENTE |2017-06-19 |2017-06-04 |               5555.00|\n|7-PRG-28H-RJS   |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2013-03-10 |2013-07-21 |               4811.00|\n|7-PRG-32HP-RJS  |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |FECHADO                    |2013-07-30 |2013-08-03 |               4698.00|\n|7-PRG-49H-RJS   |Equinor Brasil |RJ     |Campos |NA     |PEREGRINO |M         |Desenvolvimento |PRODUZINDO                 |2015-06-28 |2015-08-21 |               8080.20|\n:::\n:::\n\n\n## Criando uma coluna com mutate\n\nVamos criar uma coluna que nos dará a duração da perfuração dos poços.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npocos_03$INICIO[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2013-04-19 UTC\"\n```\n:::\n\n```{.r .cell-code}\npocos_03$TERMINO[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2013-09-28 UTC\"\n```\n:::\n\n```{.r .cell-code}\npocos_03$TERMINO[1] - pocos_03$INICIO[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTime difference of 162 days\n```\n:::\n\n```{.r .cell-code}\ndifftime(pocos_03$TERMINO[1], pocos_03$INICIO[1], units = \"days\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTime difference of 162 days\n```\n:::\n\n```{.r .cell-code}\ntempo <- difftime(pocos_03$TERMINO[1], pocos_03$INICIO[1], units = \"days\")\nstr(tempo)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n 'difftime' num 162\n - attr(*, \"units\")= chr \"days\"\n```\n:::\n\n```{.r .cell-code}\n(pocos_03$INICIO[1] %--% pocos_03$TERMINO[1])/ddays(1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 162\n```\n:::\n\n```{.r .cell-code}\npocos_03 <- pocos_03 %>% mutate(TPERF = (INICIO %--% TERMINO)/ddays(1))\nsummary(pocos_03)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     POCO             OPERADOR            ESTADO             BACIA          \n Length:83          Length:83          Length:83          Length:83         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n    BLOCO              CAMPO            TERRA_MAR          CATEGORIA        \n Length:83          Length:83          Length:83          Length:83         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n   SITUACAO             INICIO                      \n Length:83          Min.   :2010-11-10 00:00:00.00  \n Class :character   1st Qu.:2012-04-25 12:00:00.00  \n Mode  :character   Median :2014-11-07 00:00:00.00  \n                    Mean   :2015-05-18 18:47:42.65  \n                    3rd Qu.:2017-07-02 00:00:00.00  \n                    Max.   :2022-11-29 00:00:00.00  \n    TERMINO                       PROFUNDIDADE_MEDIDA_M     TPERF       \n Min.   :2010-11-11 00:00:00.00   Min.   : 269          Min.   :-347.0  \n 1st Qu.:2012-05-30 00:00:00.00   1st Qu.:4509          1st Qu.:  14.0  \n Median :2014-11-11 00:00:00.00   Median :5066          Median :  24.0  \n Mean   :2015-06-22 18:47:42.65   Mean   :5284          Mean   :  35.0  \n 3rd Qu.:2017-06-24 12:00:00.00   3rd Qu.:6410          3rd Qu.:  37.5  \n Max.   :2023-01-05 00:00:00.00   Max.   :8613          Max.   : 598.0  \n```\n:::\n:::\n\n\n### Eliminando colunas com tempos negativos\n\n\n::: {.cell}\n\n```{.r .cell-code}\npocos_03 <- pocos_03 %>% filter(TPERF > 0) \n```\n:::\n\n\n## Visualizando os dados de PEREGRINO\n\n### Box-Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pocos_03, aes(x=CAMPO, y=TPERF)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](imagens/Aula01/boxplot-1.png){width=960}\n:::\n:::\n\n\nVeja que existem alguns tempos bem elevados que estão representados por pontos no box-plot. Eles podem ser considerados pontos afastados (outliers), que neste caso vamos eliminar.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npocos_04 <- pocos_03 %>% filter(TPERF < 100)\nggplot(pocos_04, aes(x=CAMPO, y=TPERF)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](imagens/Aula01/outliers-1.png){width=960}\n:::\n:::\n\n\n### Histograma\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pocos_04, aes(x=TPERF)) +\n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](imagens/Aula01/histograma-1.png){width=960}\n:::\n:::\n\n\nVeja que desta forma o ggplot usa o seu padrão de 30 faixas de dados, que geralmente não é o mais adequado.\n\nVamos usar uma regra adequada para definição de número de faixas.\n\n### Criando um histograma usando a regra de Sturges\n\nA regra de Sturges indica 7 faixas enquanto que o padrão do ggplot2 é 30.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pocos_04, aes(x = TPERF)) +\n  geom_histogram(bins = round(1+3.322*log10(nrow(pocos_04)),0))\n```\n\n::: {.cell-output-display}\n![](imagens/Aula01/Sturges-1.png){width=960}\n:::\n:::\n\n\nVeja que agora temos um histograma mais suave.\n\n### Gráfico de Dispersão\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pocos_04, aes(x=PROFUNDIDADE_MEDIDA_M, y=TPERF)) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![](imagens/Aula01/dispersao-1.png){width=960}\n:::\n:::\n\n\nPodemos perceber que há uma relação entre o tempo de perfuração e a profundidade do poço.\n\nTambém é possível se perceber que ainda existem dados com comportamentos estranhos. Poços rasos com profundidade muito diferente dos demais, além disso um poço muito profundo com duração muito pequena.\n\nSe fossemos construir um modelo certamente terímos que investigar o porque destes comportamentos.\n\n### Alterando nome das colunas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(pocos_04)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"POCO\"                  \"OPERADOR\"              \"ESTADO\"               \n [4] \"BACIA\"                 \"BLOCO\"                 \"CAMPO\"                \n [7] \"TERRA_MAR\"             \"CATEGORIA\"             \"SITUACAO\"             \n[10] \"INICIO\"                \"TERMINO\"               \"PROFUNDIDADE_MEDIDA_M\"\n[13] \"TPERF\"                \n```\n:::\n\n```{.r .cell-code}\nnames(pocos_04) <- tolower(names(pocos_04))\nnames(pocos_04)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"poco\"                  \"operador\"              \"estado\"               \n [4] \"bacia\"                 \"bloco\"                 \"campo\"                \n [7] \"terra_mar\"             \"categoria\"             \"situacao\"             \n[10] \"inicio\"                \"termino\"               \"profundidade_medida_m\"\n[13] \"tperf\"                \n```\n:::\n:::\n",
    "supporting": [
      "Aula01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}