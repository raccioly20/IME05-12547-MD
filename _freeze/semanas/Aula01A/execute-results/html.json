{
  "hash": "44adbd4237c8f3f779558477b325c12b",
  "result": {
    "markdown": "---\ntitle: \"Carregando dados, Manipulando e Visualizando\"\nauthor: \"Ricardo Accioly\"\ndate: ' 2022-08-12 '\noutput:\n  html_document:\n    toc: yes\n    code_download: yes\n---\n\n\n\n\n\n## Entrada de dados no R\n\n## Lendo dados de arquivos xlsx\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\ndados_seg <- read_xlsx(\"C:/Users/ricar/OneDrive/Documents/GitHub/IME05-12547/indicadoressegurancapublicauf.xlsx\", col_names = TRUE, sheet = \"Ocorrências\")\nhead(dados_seg)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n  UF    `Tipo Crime`                      Ano Mês     Ocorrências\n  <chr> <chr>                           <dbl> <chr>         <dbl>\n1 Acre  Estupro                          2022 janeiro          31\n2 Acre  Furto de veículo                 2022 janeiro          50\n3 Acre  Homicídio doloso                 2022 janeiro          10\n4 Acre  Lesão corporal seguida de morte  2022 janeiro           0\n5 Acre  Roubo a instituição financeira   2022 janeiro           0\n6 Acre  Roubo de carga                   2022 janeiro           0\n```\n:::\n\n```{.r .cell-code}\nstr(dados_seg)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [20,686 × 5] (S3: tbl_df/tbl/data.frame)\n $ UF         : chr [1:20686] \"Acre\" \"Acre\" \"Acre\" \"Acre\" ...\n $ Tipo Crime : chr [1:20686] \"Estupro\" \"Furto de veículo\" \"Homicídio doloso\" \"Lesão corporal seguida de morte\" ...\n $ Ano        : num [1:20686] 2022 2022 2022 2022 2022 ...\n $ Mês        : chr [1:20686] \"janeiro\" \"janeiro\" \"janeiro\" \"janeiro\" ...\n $ Ocorrências: num [1:20686] 31 50 10 0 0 0 72 0 22 34 ...\n```\n:::\n:::\n\n\n## Lendo dados de através de uma url \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(httr)\nurl <- \"http://dados.mj.gov.br/dataset/210b9ae2-21fc-4986-89c6-2006eb4db247/resource/feeae05e-faba-406c-8a4a-512aec91a9d1/download/indicadoressegurancapublicauf.xlsx\"\nGET(url, write_disk(tf <- tempfile(fileext = \".xlsx\")))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nResponse [https://dados.mj.gov.br/dataset/210b9ae2-21fc-4986-89c6-2006eb4db247/resource/feeae05e-faba-406c-8a4a-512aec91a9d1/download/indicadoressegurancapublicauf.xlsx]\n  Date: 2022-08-12 18:33\n  Status: 200\n  Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\n  Size: 1.02 MB\n<ON DISK>  C:\\Users\\ricar\\AppData\\Local\\Temp\\Rtmp4wadjp\\file2d6462e33ec0.xlsx\n```\n:::\n\n```{.r .cell-code}\nsegur <- read_xlsx(tf, sheet = \"Ocorrências\")\nstr(segur)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [20,957 × 5] (S3: tbl_df/tbl/data.frame)\n $ UF         : chr [1:20957] \"Acre\" \"Acre\" \"Acre\" \"Acre\" ...\n $ Tipo Crime : chr [1:20957] \"Estupro\" \"Furto de veículo\" \"Homicídio doloso\" \"Lesão corporal seguida de morte\" ...\n $ Ano        : num [1:20957] 2022 2022 2022 2022 2022 ...\n $ Mês        : chr [1:20957] \"janeiro\" \"janeiro\" \"janeiro\" \"janeiro\" ...\n $ Ocorrências: num [1:20957] 31 50 10 0 0 0 72 0 22 34 ...\n```\n:::\n\n```{.r .cell-code}\nhead(segur)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n  UF    `Tipo Crime`                      Ano Mês     Ocorrências\n  <chr> <chr>                           <dbl> <chr>         <dbl>\n1 Acre  Estupro                          2022 janeiro          31\n2 Acre  Furto de veículo                 2022 janeiro          50\n3 Acre  Homicídio doloso                 2022 janeiro          10\n4 Acre  Lesão corporal seguida de morte  2022 janeiro           0\n5 Acre  Roubo a instituição financeira   2022 janeiro           0\n6 Acre  Roubo de carga                   2022 janeiro           0\n```\n:::\n:::\n\n\n\n\n## Bibliotecas\n\nVamos carregar as bibliotecas que serão usadas na manipulação e visualização de dados. \n\nO pacote tidyverse carrega diversos pacotes muito uteis na manipulação e visualização de dados \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"tidyverse\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6     ✔ purrr   0.3.4\n✔ tibble  3.1.8     ✔ dplyr   1.0.9\n✔ tidyr   1.2.0     ✔ stringr 1.4.0\n✔ readr   2.1.2     ✔ forcats 0.5.1\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(dados_seg)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 20,686\nColumns: 5\n$ UF           <chr> \"Acre\", \"Acre\", \"Acre\", \"Acre\", \"Acre\", \"Acre\", \"Acre\", \"…\n$ `Tipo Crime` <chr> \"Estupro\", \"Furto de veículo\", \"Homicídio doloso\", \"Lesão…\n$ Ano          <dbl> 2022, 2022, 2022, 2022, 2022, 2022, 2022, 2022, 2022, 202…\n$ Mês          <chr> \"janeiro\", \"janeiro\", \"janeiro\", \"janeiro\", \"janeiro\", \"j…\n$ Ocorrências  <dbl> 31, 50, 10, 0, 0, 0, 72, 0, 22, 34, 55, 10, 0, 0, 0, 48, …\n```\n:::\n\n```{.r .cell-code}\nunique(dados_seg$UF)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Acre\"                \"Alagoas\"             \"Amapá\"              \n [4] \"Amazonas\"            \"Bahia\"               \"Ceará\"              \n [7] \"Distrito Federal\"    \"Espírito Santo\"      \"Goiás\"              \n[10] \"Maranhão\"            \"Mato Grosso\"         \"Mato Grosso do Sul\" \n[13] \"Minas Gerais\"        \"Pará\"                \"Paraíba\"            \n[16] \"Paraná\"              \"Pernambuco\"          \"Piauí\"              \n[19] \"Rio Grande do Norte\" \"Rio Grande do Sul\"   \"Rondônia\"           \n[22] \"Roraima\"             \"Santa Catarina\"      \"São Paulo\"          \n[25] \"Sergipe\"             \"Tocantins\"           \"Rio de Janeiro\"     \n```\n:::\n\n```{.r .cell-code}\ndados_segRJ <- dados_seg %>% filter(UF==\"Rio de Janeiro\")\nsummary(dados_segRJ)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      UF             Tipo Crime             Ano           Mês           \n Length:756         Length:756         Min.   :2015   Length:756        \n Class :character   Class :character   1st Qu.:2016   Class :character  \n Mode  :character   Mode  :character   Median :2018   Mode  :character  \n                                       Mean   :2018                     \n                                       3rd Qu.:2020                     \n                                       Max.   :2021                     \n  Ocorrências    \n Min.   :   0.0  \n 1st Qu.:  10.0  \n Median : 335.0  \n Mean   : 683.3  \n 3rd Qu.: 744.5  \n Max.   :5358.0  \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(dados_segRJ$`Tipo Crime`)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Estupro\"                             \"Furto de veículo\"                   \n[3] \"Homicídio doloso\"                    \"Lesão corporal seguida de morte\"    \n[5] \"Roubo a instituição financeira\"      \"Roubo de carga\"                     \n[7] \"Roubo de veículo\"                    \"Roubo seguido de morte (latrocínio)\"\n[9] \"Tentativa de homicídio\"             \n```\n:::\n\n```{.r .cell-code}\ndados_segRJ$`Tipo Crime` <- as.factor(dados_segRJ$`Tipo Crime`)\ndados_segRJ %>% filter(`Tipo Crime`==\"Homicídio doloso\" ) %>% ggplot(aes(x=as.factor(Ano), y=Ocorrências)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](imagens/Aula01A/manipulando2-1.png){width=960}\n:::\n\n```{.r .cell-code}\ndados_segRJ %>% filter(`Tipo Crime`==\"Roubo de veículo\" ) %>% ggplot(aes(x=as.factor(Ano), y=Ocorrências)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](imagens/Aula01A/manipulando2-2.png){width=960}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsintese_RJ <- dados_segRJ %>% group_by(Ano,`Tipo Crime`) %>% summarise(total = sum(Ocorrências))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'Ano'. You can override using the `.groups`\nargument.\n```\n:::\n\n```{.r .cell-code}\nsintese_RJ %>% ggplot(aes(x=Ano, y=total, color=`Tipo Crime`)) + geom_point() + geom_line()\n```\n\n::: {.cell-output-display}\n![](imagens/Aula01A/manipulando3-1.png){width=960}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}