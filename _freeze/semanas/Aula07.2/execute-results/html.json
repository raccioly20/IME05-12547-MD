{
  "hash": "d3aff80eb699bba7282a8bcad9f7db1e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Regressão Linear Múltipla\"\nauthor: \"Ricardo Accioly\"\ndate: \"2024-04-04\"\nformat:\n  html:\n    grid: \n      margin-width: 350px\n    code-link: TRUE\nreference-location: margin\ncitation-location: margin\n---\n\n\n## Carregando bibliotecas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n:::\n\n\n## Dados de propaganda\n\nO conjunto de dados contém estatísticas sobre as vendas de um produto em 200 diferentes mercados, juntamente com orçamentos publicitários em cada um desses mercados, para diferentes canais de mídia: TV, rádio e jornal. As vendas estão em milhares de unidades e o orçamento está em milhares de dólares.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\npropaganda <- read_excel(\"Propaganda.xlsx\")\nsummary(propaganda)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       TV             Radio          Newspaper          Sales      \n Min.   :  0.70   Min.   : 0.000   Min.   :  0.30   Min.   : 1.60  \n 1st Qu.: 74.38   1st Qu.: 9.975   1st Qu.: 12.75   1st Qu.:10.38  \n Median :149.75   Median :22.900   Median : 25.75   Median :12.90  \n Mean   :147.04   Mean   :23.264   Mean   : 30.55   Mean   :14.02  \n 3rd Qu.:218.82   3rd Qu.:36.525   3rd Qu.: 45.10   3rd Qu.:17.40  \n Max.   :296.40   Max.   :49.600   Max.   :114.00   Max.   :27.00  \n```\n\n\n:::\n:::\n\n\n## Renomeando\n\n\n::: {.cell}\n\n```{.r .cell-code}\npropaganda <- propaganda %>% rename(Jornal = Newspaper, Vendas = Sales)\n```\n:::\n\n\n## Sumario\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(propaganda)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       TV             Radio            Jornal           Vendas     \n Min.   :  0.70   Min.   : 0.000   Min.   :  0.30   Min.   : 1.60  \n 1st Qu.: 74.38   1st Qu.: 9.975   1st Qu.: 12.75   1st Qu.:10.38  \n Median :149.75   Median :22.900   Median : 25.75   Median :12.90  \n Mean   :147.04   Mean   :23.264   Mean   : 30.55   Mean   :14.02  \n 3rd Qu.:218.82   3rd Qu.:36.525   3rd Qu.: 45.10   3rd Qu.:17.40  \n Max.   :296.40   Max.   :49.600   Max.   :114.00   Max.   :27.00  \n```\n\n\n:::\n\n```{.r .cell-code}\nnrow(propaganda)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 200\n```\n\n\n:::\n:::\n\n\n## Linhas inicias\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gt)\ngt(head(propaganda, 10))  %>% \n  tab_header(title = \"Propaganda\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"keaztvflih\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#keaztvflih table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#keaztvflih thead, #keaztvflih tbody, #keaztvflih tfoot, #keaztvflih tr, #keaztvflih td, #keaztvflih th {\n  border-style: none;\n}\n\n#keaztvflih p {\n  margin: 0;\n  padding: 0;\n}\n\n#keaztvflih .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#keaztvflih .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#keaztvflih .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#keaztvflih .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#keaztvflih .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#keaztvflih .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#keaztvflih .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#keaztvflih .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#keaztvflih .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#keaztvflih .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#keaztvflih .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#keaztvflih .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#keaztvflih .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#keaztvflih .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#keaztvflih .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#keaztvflih .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#keaztvflih .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#keaztvflih .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#keaztvflih .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#keaztvflih .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#keaztvflih .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#keaztvflih .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#keaztvflih .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#keaztvflih .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#keaztvflih .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#keaztvflih .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#keaztvflih .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#keaztvflih .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#keaztvflih .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#keaztvflih .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#keaztvflih .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#keaztvflih .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#keaztvflih .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#keaztvflih .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#keaztvflih .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#keaztvflih .gt_left {\n  text-align: left;\n}\n\n#keaztvflih .gt_center {\n  text-align: center;\n}\n\n#keaztvflih .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#keaztvflih .gt_font_normal {\n  font-weight: normal;\n}\n\n#keaztvflih .gt_font_bold {\n  font-weight: bold;\n}\n\n#keaztvflih .gt_font_italic {\n  font-style: italic;\n}\n\n#keaztvflih .gt_super {\n  font-size: 65%;\n}\n\n#keaztvflih .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#keaztvflih .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#keaztvflih .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#keaztvflih .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#keaztvflih .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#keaztvflih .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#keaztvflih .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"4\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Propaganda</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"TV\">TV</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Radio\">Radio</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Jornal\">Jornal</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Vendas\">Vendas</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"TV\" class=\"gt_row gt_right\">230.1</td>\n<td headers=\"Radio\" class=\"gt_row gt_right\">37.8</td>\n<td headers=\"Jornal\" class=\"gt_row gt_right\">69.2</td>\n<td headers=\"Vendas\" class=\"gt_row gt_right\">22.1</td></tr>\n    <tr><td headers=\"TV\" class=\"gt_row gt_right\">44.5</td>\n<td headers=\"Radio\" class=\"gt_row gt_right\">39.3</td>\n<td headers=\"Jornal\" class=\"gt_row gt_right\">45.1</td>\n<td headers=\"Vendas\" class=\"gt_row gt_right\">10.4</td></tr>\n    <tr><td headers=\"TV\" class=\"gt_row gt_right\">17.2</td>\n<td headers=\"Radio\" class=\"gt_row gt_right\">45.9</td>\n<td headers=\"Jornal\" class=\"gt_row gt_right\">69.3</td>\n<td headers=\"Vendas\" class=\"gt_row gt_right\">9.3</td></tr>\n    <tr><td headers=\"TV\" class=\"gt_row gt_right\">151.5</td>\n<td headers=\"Radio\" class=\"gt_row gt_right\">41.3</td>\n<td headers=\"Jornal\" class=\"gt_row gt_right\">58.5</td>\n<td headers=\"Vendas\" class=\"gt_row gt_right\">18.5</td></tr>\n    <tr><td headers=\"TV\" class=\"gt_row gt_right\">180.8</td>\n<td headers=\"Radio\" class=\"gt_row gt_right\">10.8</td>\n<td headers=\"Jornal\" class=\"gt_row gt_right\">58.4</td>\n<td headers=\"Vendas\" class=\"gt_row gt_right\">12.9</td></tr>\n    <tr><td headers=\"TV\" class=\"gt_row gt_right\">8.7</td>\n<td headers=\"Radio\" class=\"gt_row gt_right\">48.9</td>\n<td headers=\"Jornal\" class=\"gt_row gt_right\">75.0</td>\n<td headers=\"Vendas\" class=\"gt_row gt_right\">7.2</td></tr>\n    <tr><td headers=\"TV\" class=\"gt_row gt_right\">57.5</td>\n<td headers=\"Radio\" class=\"gt_row gt_right\">32.8</td>\n<td headers=\"Jornal\" class=\"gt_row gt_right\">23.5</td>\n<td headers=\"Vendas\" class=\"gt_row gt_right\">11.8</td></tr>\n    <tr><td headers=\"TV\" class=\"gt_row gt_right\">120.2</td>\n<td headers=\"Radio\" class=\"gt_row gt_right\">19.6</td>\n<td headers=\"Jornal\" class=\"gt_row gt_right\">11.6</td>\n<td headers=\"Vendas\" class=\"gt_row gt_right\">13.2</td></tr>\n    <tr><td headers=\"TV\" class=\"gt_row gt_right\">8.6</td>\n<td headers=\"Radio\" class=\"gt_row gt_right\">2.1</td>\n<td headers=\"Jornal\" class=\"gt_row gt_right\">1.0</td>\n<td headers=\"Vendas\" class=\"gt_row gt_right\">4.8</td></tr>\n    <tr><td headers=\"TV\" class=\"gt_row gt_right\">199.8</td>\n<td headers=\"Radio\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"Jornal\" class=\"gt_row gt_right\">21.2</td>\n<td headers=\"Vendas\" class=\"gt_row gt_right\">10.6</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n## Criando amostra de treino e teste\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(caret)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCarregando pacotes exigidos: lattice\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'caret'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:purrr':\n\n    lift\n```\n\n\n:::\n\n```{.r .cell-code}\nset.seed(21)\ny <- propaganda$Vendas\nindice_teste <- createDataPartition(y, times = 1, p = 0.40, list = FALSE)\n\nconj_treino <- propaganda[-indice_teste, ]\nconj_teste <- propaganda[indice_teste, ]\n\nstr(conj_treino)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [119 × 4] (S3: tbl_df/tbl/data.frame)\n $ TV    : num [1:119] 230.1 151.5 180.8 199.8 66.1 ...\n $ Radio : num [1:119] 37.8 41.3 10.8 2.6 5.8 35.1 7.6 47.7 20.5 23.9 ...\n $ Jornal: num [1:119] 69.2 58.5 58.4 21.2 24.2 65.9 7.2 52.9 18.3 19.1 ...\n $ Vendas: num [1:119] 22.1 18.5 12.9 10.6 8.6 9.2 9.7 22.4 11.3 14.6 ...\n```\n\n\n:::\n\n```{.r .cell-code}\nstr(conj_teste)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [81 × 4] (S3: tbl_df/tbl/data.frame)\n $ TV    : num [1:81] 44.5 17.2 8.7 57.5 120.2 ...\n $ Radio : num [1:81] 39.3 45.9 48.9 32.8 19.6 2.1 24 32.9 36.6 39.6 ...\n $ Jornal: num [1:81] 45.1 69.3 75 23.5 11.6 1 4 46 114 55.8 ...\n $ Vendas: num [1:81] 10.4 9.3 7.2 11.8 13.2 4.8 17.4 19 12.5 24.4 ...\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(skimr)\nconj_treino %>% skim()\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |           |\n|:------------------------|:----------|\n|Name                     |Piped data |\n|Number of rows           |119        |\n|Number of columns        |4          |\n|_______________________  |           |\n|Column type frequency:   |           |\n|numeric                  |4          |\n|________________________ |           |\n|Group variables          |None       |\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|   mean|    sd|  p0|   p25|   p50|    p75|  p100|hist  |\n|:-------------|---------:|-------------:|------:|-----:|---:|-----:|-----:|------:|-----:|:-----|\n|TV            |         0|             1| 150.82| 84.00| 0.7| 77.30| 149.8| 224.90| 293.6|▆▇▆▇▇ |\n|Radio         |         0|             1|  21.27| 14.31| 0.3|  8.30|  20.5|  32.65|  49.4|▇▅▆▃▃ |\n|Jornal        |         0|             1|  29.39| 19.63| 1.8| 13.65|  24.2|  41.00|  89.4|▇▇▃▂▁ |\n|Vendas        |         0|             1|  13.94|  5.02| 1.6| 10.35|  12.9|  17.25|  26.2|▁▇▇▃▂ |\n\n\n:::\n\n```{.r .cell-code}\nconj_teste %>% skim()\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |           |\n|:------------------------|:----------|\n|Name                     |Piped data |\n|Number of rows           |81         |\n|Number of columns        |4          |\n|_______________________  |           |\n|Column type frequency:   |           |\n|numeric                  |4          |\n|________________________ |           |\n|Group variables          |None       |\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|   mean|    sd|  p0|  p25|   p50|   p75|  p100|hist  |\n|:-------------|---------:|-------------:|------:|-----:|---:|----:|-----:|-----:|-----:|:-----|\n|TV            |         0|             1| 141.50| 88.75| 4.1| 67.8| 149.7| 216.8| 296.4|▇▆▅▇▃ |\n|Radio         |         0|             1|  26.19| 15.22| 0.0| 12.6|  27.7|  39.3|  49.6|▇▆▆▇▇ |\n|Jornal        |         0|             1|  32.26| 24.63| 0.3|  9.3|  31.5|  46.2| 114.0|▇▆▃▁▁ |\n|Vendas        |         0|             1|  14.15|  5.53| 3.2| 10.4|  12.9|  17.4|  27.0|▃▇▆▃▃ |\n\n\n:::\n:::\n\n\n## E se eu usar uma outra semente?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(23)\ny2 <- propaganda$Vendas\nindice_teste2 <- createDataPartition(y2, times = 1, p = 0.40, list = FALSE)\n\nconj_treino2 <- propaganda[-indice_teste2, ]\nconj_teste2 <- propaganda[indice_teste2, ]\n\nconj_treino2 %>% skim()\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |           |\n|:------------------------|:----------|\n|Name                     |Piped data |\n|Number of rows           |119        |\n|Number of columns        |4          |\n|_______________________  |           |\n|Column type frequency:   |           |\n|numeric                  |4          |\n|________________________ |           |\n|Group variables          |None       |\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|   mean|    sd|  p0|   p25|   p50|    p75|  p100|hist  |\n|:-------------|---------:|-------------:|------:|-----:|---:|-----:|-----:|------:|-----:|:-----|\n|TV            |         0|             1| 140.38| 85.41| 0.7| 69.90| 139.2| 210.15| 296.4|▇▇▆▇▆ |\n|Radio         |         0|             1|  24.23| 14.77| 0.0| 11.85|  25.7|  36.85|  49.4|▇▆▇▆▇ |\n|Jornal        |         0|             1|  29.45| 21.96| 0.3| 11.75|  23.2|  43.10| 100.9|▇▆▃▂▁ |\n|Vendas        |         0|             1|  13.93|  5.20| 1.6| 10.25|  12.9|  17.35|  26.2|▁▇▇▅▃ |\n\n\n:::\n\n```{.r .cell-code}\nconj_teste2 %>% skim()\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |           |\n|:------------------------|:----------|\n|Name                     |Piped data |\n|Number of rows           |81         |\n|Number of columns        |4          |\n|_______________________  |           |\n|Column type frequency:   |           |\n|numeric                  |4          |\n|________________________ |           |\n|Group variables          |None       |\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|   mean|    sd|  p0|  p25|   p50|   p75|  p100|hist  |\n|:-------------|---------:|-------------:|------:|-----:|---:|----:|-----:|-----:|-----:|:-----|\n|TV            |         0|             1| 156.83| 86.09| 4.1| 75.5| 170.2| 228.3| 289.7|▅▅▅▇▇ |\n|Radio         |         0|             1|  21.85| 14.94| 0.4|  9.3|  20.1|  35.0|  49.6|▇▅▅▅▃ |\n|Jornal        |         0|             1|  32.17| 21.54| 1.7| 17.0|  30.0|  47.4| 114.0|▇▆▅▁▁ |\n|Vendas        |         0|             1|  14.16|  5.28| 3.2| 10.4|  12.9|  17.4|  27.0|▂▇▆▃▂ |\n\n\n:::\n:::\n\n\nVeja que as amostram ficaram com resultados diferentes, o que levaria a obtermos modelos diferentes num ajuste de regressão!\n\n## Regressão Simples\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod1 <- lm( Vendas ~ TV, data = conj_treino)\nmod2 <- lm( Vendas ~ Radio, data = conj_treino)\nmod3 <- lm( Vendas ~ Jornal, data = conj_treino)\n```\n:::\n\n\n## 1a Regressão Multipla\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCarregando pacotes exigidos: carData\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'car'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:dplyr':\n\n    recode\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:purrr':\n\n    some\n```\n\n\n:::\n\n```{.r .cell-code}\nscatterplotMatrix(conj_treino)\n```\n\n::: {.cell-output-display}\n![](Aula07.2_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\nmod4 <- lm( Vendas ~ TV + Radio + Jornal, data = conj_treino)\nsummary(mod4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Vendas ~ TV + Radio + Jornal, data = conj_treino)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-9.1595 -0.6961  0.2676  1.0298  2.5871 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 3.268910   0.391828   8.343 1.81e-13 ***\nTV          0.042705   0.001776  24.039  < 2e-16 ***\nRadio       0.186439   0.011458  16.272  < 2e-16 ***\nJornal      0.008931   0.008292   1.077    0.284    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.606 on 115 degrees of freedom\nMultiple R-squared:  0.9002,\tAdjusted R-squared:  0.8976 \nF-statistic: 345.9 on 3 and 115 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\nVejam que ao analisarmos a estatística t de Jornal percebemos que não podemos rejeitar a hipótese de que o coeficiente de Jornal possa ser zero.\n\nVamos refazer o modleo sem Jornal.\n\n## 2a Regressao Multipla\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod5 <- lm( Vendas ~ TV + Radio, data = conj_treino)\nsummary(mod5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Vendas ~ TV + Radio, data = conj_treino)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-9.4585 -0.6886  0.1687  1.0799  2.5529 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 3.441076   0.357985   9.612   <2e-16 ***\nTV          0.042575   0.001774  24.005   <2e-16 ***\nRadio       0.191607   0.010412  18.402   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.607 on 116 degrees of freedom\nMultiple R-squared:  0.8992,\tAdjusted R-squared:  0.8975 \nF-statistic: 517.5 on 2 and 116 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\nAgora todas as variáveis tem indicação de significância estatística.\n\n## Confirmando o teste t com o teste F (ANOVA)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(mod5, mod4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nModel 1: Vendas ~ TV + Radio\nModel 2: Vendas ~ TV + Radio + Jornal\n  Res.Df    RSS Df Sum of Sq    F Pr(>F)\n1    116 299.47                         \n2    115 296.48  1    2.9906 1.16 0.2837\n```\n\n\n:::\n:::\n\n\n## Vamos comparar com o modelo só com TV\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(mod1, mod5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nModel 1: Vendas ~ TV\nModel 2: Vendas ~ TV + Radio\n  Res.Df     RSS Df Sum of Sq      F    Pr(>F)    \n1    117 1173.73                                  \n2    116  299.47  1    874.26 338.65 < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nVeja que agora a diferença é significativa. O melhor modelo é o com TV e Radio (mod5)\n\n## Calculando o erro padrão do resíduo com amostra de teste\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsqrt(mean((conj_teste$Vendas - predict(mod5, conj_teste)) ^ 2)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.846764\n```\n\n\n:::\n:::\n\n\n## Comparando com a melhor regressão simples\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Modelo com somente TV\nsummary(mod1)$sigma\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.167319\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(mod1)$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.605027\n```\n\n\n:::\n\n```{.r .cell-code}\nsqrt(mean((conj_teste$Vendas - predict(mod1, conj_teste)) ^ 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.41382\n```\n\n\n:::\n\n```{.r .cell-code}\n## Modelo com TV e Jornal\nsummary(mod5)$sigma\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.606744\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(mod5)$adj.r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.8974883\n```\n\n\n:::\n\n```{.r .cell-code}\nsqrt(mean((conj_teste$Vendas - predict(mod5, conj_teste)) ^ 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.846764\n```\n\n\n:::\n:::\n\n\n## Comparando valor real vs ajustado\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconj_treino$Previsoes <- predict(mod5, data=conj_treino)\nggplot(conj_treino, aes(x=Previsoes, y=Vendas)) + \n  geom_point() +\n  geom_abline(color = \"darkblue\") +\n  ggtitle(\"Vendas vs. Previsões do modelo linear\")\n```\n\n::: {.cell-output-display}\n![](Aula07.2_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n## Análise Inicial dos Resíduos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(mod5)\n```\n\n::: {.cell-output-display}\n![](Aula07.2_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Aula07.2_files/figure-html/unnamed-chunk-16-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Aula07.2_files/figure-html/unnamed-chunk-16-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Aula07.2_files/figure-html/unnamed-chunk-16-4.png){width=672}\n:::\n:::\n\n\n## Análise do Modelo - Parte 2\n\nO pacote easystats tem uma função que faz uma análise mais detalhada do modelo. Os gráficos são mais fáceis de interpretar do que os obtidos com o plot do R base.\n\n\n::: {.cell .fig-column-page-right}\n\n```{.r .cell-code}\nlibrary(easystats)\ncheck_model(mod5)\n```\n\n::: {.cell-output-display}\n![](Aula07.2_files/figure-html/unnamed-chunk-17-1.png){width=1056}\n:::\n:::\n\n\n## Análise do Modelo - Parte 3\n\nO pacote car apresenta funções mais avançadas para análise de resíduos.\n\nPara o gráfico de resíduos versus valores ajustados, podemos usar um teste chamado teste de Tukey de não aditividade (Tukey, 1949), ele é obtido adicionando os quadrados dos valores ajustados ao modelo e reajustando. O valor p para o teste de Tukey é obtido comparando a estatística de teste para a distribuição padrão-normal. O teste confirma a visível impressão de curvatura no gráfico residual, reforçando ainda mais a conclusão que o modelo não é adequado.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\nresidualPlots(mod5)\n```\n\n::: {.cell-output-display}\n![](Aula07.2_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           Test stat Pr(>|Test stat|)    \nTV           -4.8383        4.102e-06 ***\nRadio         1.9290           0.0562 .  \nTukey test    6.4114        1.442e-10 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\ninfluencePlot(mod5)\n```\n\n::: {.cell-output-display}\n![](Aula07.2_files/figure-html/unnamed-chunk-18-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     StudRes        Hat     CookD\n45 -2.512087 0.05650813 0.1204704\n83 -7.289206 0.05466694 0.7066190\n```\n\n\n:::\n:::\n\n\n## Tentando avaliar transformações\n\nAqui vamos avaliar a necessidade de transformar as variáveis para melhorar o modelo.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(p1 <- powerTransform(Vendas ~ TV + Radio, data=conj_treino))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nbcPower Transformation to Normality \n   Est Power Rounded Pwr Wald Lwr Bnd Wald Upr Bnd\nY1    0.9937           1       0.8018       1.1856\n\nLikelihood ratio test that transformation parameter is equal to 0\n (log transformation)\n                          LRT df       pval\nLR test, lambda = (0) 111.042  1 < 2.22e-16\n\nLikelihood ratio test that no transformation is needed\n                              LRT df    pval\nLR test, lambda = (1) 0.004149754  1 0.94864\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(p2 <- powerTransform(cbind(TV, Radio) ~1 , data=conj_treino))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nbcPower Transformations to Multinormality \n      Est Power Rounded Pwr Wald Lwr Bnd Wald Upr Bnd\nTV       0.7692         1.0       0.5311       1.0073\nRadio    0.5349         0.5       0.3429       0.7269\n\nLikelihood ratio test that transformation parameters are equal to 0\n (all log transformations)\n                            LRT df       pval\nLR test, lambda = (0 0) 102.457  2 < 2.22e-16\n\nLikelihood ratio test that no transformations are needed\n                           LRT df       pval\nLR test, lambda = (1 1) 22.189  2 1.5196e-05\n```\n\n\n:::\n\n```{.r .cell-code}\nboxCox(mod5, lambda = seq(-2, 2, 1/10))\n```\n\n::: {.cell-output-display}\n![](Aula07.2_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n## Análise do Modelo com car\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fator de inflação da variância\nvif(mod5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      TV    Radio \n1.014454 1.014454 \n```\n\n\n:::\n:::\n\n\n# Teste dos resíduos\n\nTeste de normalidade Teste de heterocedasticidade (Bresch-Pagan) Teste de autocorrelação (Durbin-Watson)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lmtest)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCarregando pacotes exigidos: zoo\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'zoo'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n```\n\n\n:::\n\n```{.r .cell-code}\nmod5_sum <- summary(mod5)\n# Teste de normalidade\nshapiro.test(mod5_sum$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  mod5_sum$residuals\nW = 0.8645, p-value = 4.88e-09\n```\n\n\n:::\n\n```{.r .cell-code}\n# Teste de heterocedasticidade\nbptest(mod5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tstudentized Breusch-Pagan test\n\ndata:  mod5\nBP = 4.9152, df = 2, p-value = 0.08564\n```\n\n\n:::\n\n```{.r .cell-code}\n#Teste de autocorrelação\ndwtest(mod5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tDurbin-Watson test\n\ndata:  mod5\nDW = 2.1717, p-value = 0.8286\nalternative hypothesis: true autocorrelation is greater than 0\n```\n\n\n:::\n:::\n\n\n## Dado que parece outlier e é um valor influente\n\nA função OutlierTest () no pacote do car localiza o maior resíduo studentizado em valor absoluto e calcula o teste t com correção de Bonferroni. O testes de Outlier utiliza uma distribuição t para testar se o maior valor do residuo studentizado do modelo é estatisticamente diferente das outras observações. Um valor p significativo indica um outlier extremo que merece um exame mais aprofundado.\n\n\n::: {.cell}\n\n```{.r .cell-code}\noutlierTest(mod5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    rstudent unadjusted p-value Bonferroni p\n83 -7.289206         4.2486e-11   5.0558e-09\n```\n\n\n:::\n\n```{.r .cell-code}\nconj_treino[83,]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 5\n     TV Radio Jornal Vendas Previsoes\n  <dbl> <dbl>  <dbl>  <dbl>     <dbl>\n1   0.7  39.6    8.7    1.6      11.1\n```\n\n\n:::\n:::\n",
    "supporting": [
      "Aula07.2_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}