{
  "hash": "eb42cdcb9bdcae67789293c058575e74",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Problemas na Regressão Multipla\"\nauthor: \"Ricardo Accioly\"\ndate: \"2025-09-03\"\nformat:\n  html:\n    grid: \n      margin-width: 350px\n    code-link: TRUE\nreference-location: margin\ncitation-location: margin\nknitr:\n  opts_chunk: \n    out.width: 90%\n    comment: \"#>\"\nexecute:\n  freeze: auto\n  message: false\n---\n\n## Carregando bibliotecas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#> ✔ dplyr     1.1.4     ✔ readr     2.1.5\n#> ✔ forcats   1.0.0     ✔ stringr   1.5.1\n#> ✔ ggplot2   3.5.2     ✔ tibble    3.3.0\n#> ✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n#> ✔ purrr     1.1.0     \n#> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#> ✖ dplyr::filter() masks stats::filter()\n#> ✖ dplyr::lag()    masks stats::lag()\n#> ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(caret)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Carregando pacotes exigidos: lattice\n#> \n#> Anexando pacote: 'caret'\n#> \n#> O seguinte objeto é mascarado por 'package:purrr':\n#> \n#>     lift\n```\n\n\n:::\n:::\n\n\n## Dados de pressão sanguinea\n\n-   BP = Pressão sanguínea (em mm Hg)\n\n-   Age = idade (em anos)\n\n-   Weight = peso (em kg)\n\n-   BSA = area superficial do corpo (em m2)\n\n-   Dur = duração da hipertensão (em anos)\n\n-   Pulse = batimentos (batidas por minuto)\n\n-   Stress = índice de stress\n\n\n::: {.cell}\n\n```{.r .cell-code}\npressao_sangue <- read_delim(\"bloodpress.txt\", col_names = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Rows: 20 Columns: 8\n#> ── Column specification ────────────────────────────────────────────────────────\n#> Delimiter: \"\\t\"\n#> dbl (8): Pt, BP, Age, Weight, BSA, Dur, Pulse, Stress\n#> \n#> ℹ Use `spec()` to retrieve the full column specification for this data.\n#> ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n## Renomeando\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(pressao_sangue)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> Rows: 20\n#> Columns: 8\n#> $ Pt     <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, …\n#> $ BP     <dbl> 105, 115, 116, 117, 112, 121, 121, 110, 110, 114, 114, 115, 114…\n#> $ Age    <dbl> 47, 49, 49, 50, 51, 48, 49, 47, 49, 48, 47, 49, 50, 45, 52, 46,…\n#> $ Weight <dbl> 85.4, 94.2, 95.3, 94.7, 89.4, 99.5, 99.8, 90.9, 89.2, 92.7, 94.…\n#> $ BSA    <dbl> 1.75, 2.10, 1.98, 2.01, 1.89, 2.25, 2.25, 1.90, 1.83, 2.07, 2.0…\n#> $ Dur    <dbl> 5.1, 3.8, 8.2, 5.8, 7.0, 9.3, 2.5, 6.2, 7.1, 5.6, 5.3, 5.6, 10.…\n#> $ Pulse  <dbl> 63, 70, 72, 73, 72, 71, 69, 66, 69, 64, 74, 71, 68, 67, 76, 69,…\n#> $ Stress <dbl> 33, 14, 10, 99, 95, 10, 42, 8, 62, 35, 90, 21, 47, 80, 98, 95, …\n```\n\n\n:::\n\n```{.r .cell-code}\npressao_sangue <- pressao_sangue %>% rename(PS = BP, Idade = Age,\n                                            Peso = Weight, Acorp = BSA,\n                                            Pulso = Pulse) %>% select(-Pt)\n```\n:::\n\n\n## Sumario\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(pressao_sangue)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>        PS            Idade            Peso            Acorp      \n#>  Min.   :105.0   Min.   :45.00   Min.   : 85.40   Min.   :1.750  \n#>  1st Qu.:110.0   1st Qu.:47.00   1st Qu.: 90.22   1st Qu.:1.897  \n#>  Median :114.0   Median :48.50   Median : 94.15   Median :1.980  \n#>  Mean   :114.0   Mean   :48.60   Mean   : 93.09   Mean   :1.998  \n#>  3rd Qu.:116.2   3rd Qu.:49.25   3rd Qu.: 94.85   3rd Qu.:2.075  \n#>  Max.   :125.0   Max.   :56.00   Max.   :101.30   Max.   :2.250  \n#>       Dur            Pulso           Stress     \n#>  Min.   : 2.50   Min.   :62.00   Min.   : 8.00  \n#>  1st Qu.: 5.25   1st Qu.:67.75   1st Qu.:17.00  \n#>  Median : 6.00   Median :70.00   Median :44.50  \n#>  Mean   : 6.43   Mean   :69.60   Mean   :53.35  \n#>  3rd Qu.: 7.60   3rd Qu.:72.00   3rd Qu.:95.00  \n#>  Max.   :10.20   Max.   :76.00   Max.   :99.00\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(corrplot)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> corrplot 0.95 loaded\n```\n\n\n:::\n\n```{.r .cell-code}\nmat_corr <- cor(cor(pressao_sangue))\ncorrplot(mat_corr)\n```\n\n::: {.cell-output-display}\n![](Aula07.2B_files/figure-html/unnamed-chunk-5-1.png){width=90%}\n:::\n\n```{.r .cell-code}\ncor(pressao_sangue)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>               PS     Idade       Peso      Acorp       Dur     Pulso     Stress\n#> PS     1.0000000 0.6590930 0.95006765 0.86587887 0.2928336 0.7214132 0.16390139\n#> Idade  0.6590930 1.0000000 0.40734926 0.37845460 0.3437921 0.6187643 0.36822369\n#> Peso   0.9500677 0.4073493 1.00000000 0.87530481 0.2006496 0.6593399 0.03435475\n#> Acorp  0.8658789 0.3784546 0.87530481 1.00000000 0.1305400 0.4648188 0.01844634\n#> Dur    0.2928336 0.3437921 0.20064959 0.13054001 1.0000000 0.4015144 0.31163982\n#> Pulso  0.7214132 0.6187643 0.65933987 0.46481881 0.4015144 1.0000000 0.50631008\n#> Stress 0.1639014 0.3682237 0.03435475 0.01844634 0.3116398 0.5063101 1.00000000\n```\n\n\n:::\n:::\n\n\nAqui vemos que a presssão sanguinea tem uma correlação forte com o peso e também com a área corporal. O peso e a area corporal tem uma correlação forte. Esta correlação alta pode indicar a existencia de multicolinearidade.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(psych)\npairs.panels(pressao_sangue)\n```\n\n::: {.cell-output-display}\n![](Aula07.2B_files/figure-html/unnamed-chunk-6-1.png){width=90%}\n:::\n:::\n\n\n## Criando conjunto de treino e teste\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(caret)\nset.seed(25)\ny <- pressao_sangue$PS\nindice_teste <- createDataPartition(y, times = 1, p = 0.20, list = FALSE)\n\nconj_treino <- pressao_sangue[-indice_teste, ]\nconj_teste <- pressao_sangue[indice_teste, ]\n\nglimpse(conj_treino)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> Rows: 14\n#> Columns: 7\n#> $ PS     <dbl> 105, 116, 117, 121, 110, 110, 114, 114, 115, 114, 125, 114, 110…\n#> $ Idade  <dbl> 47, 49, 50, 49, 47, 49, 48, 47, 49, 50, 52, 46, 48, 56\n#> $ Peso   <dbl> 85.4, 95.3, 94.7, 99.8, 90.9, 89.2, 92.7, 94.4, 94.1, 91.6, 101…\n#> $ Acorp  <dbl> 1.75, 1.98, 2.01, 2.25, 1.90, 1.83, 2.07, 2.07, 1.98, 2.05, 2.1…\n#> $ Dur    <dbl> 5.1, 8.2, 5.8, 2.5, 6.2, 7.1, 5.6, 5.3, 5.6, 10.2, 10.0, 7.4, 9…\n#> $ Pulso  <dbl> 63, 72, 73, 69, 66, 69, 64, 74, 71, 68, 76, 69, 71, 75\n#> $ Stress <dbl> 33, 10, 99, 42, 8, 62, 35, 90, 21, 47, 98, 95, 99, 99\n```\n\n\n:::\n\n```{.r .cell-code}\nglimpse(conj_teste)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> Rows: 6\n#> Columns: 7\n#> $ PS     <dbl> 115, 112, 121, 106, 106, 113\n#> $ Idade  <dbl> 49, 51, 48, 45, 46, 46\n#> $ Peso   <dbl> 94.2, 89.4, 99.5, 87.1, 87.0, 94.5\n#> $ Acorp  <dbl> 2.10, 1.89, 2.25, 1.92, 1.87, 1.90\n#> $ Dur    <dbl> 3.8, 7.0, 9.3, 5.6, 3.6, 4.3\n#> $ Pulso  <dbl> 70, 72, 71, 67, 62, 70\n#> $ Stress <dbl> 14, 95, 10, 80, 18, 12\n```\n\n\n:::\n:::\n\n\n## 1a. Avaliação\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod1 <- lm(PS ~ ., data=conj_treino)\nsummary(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> \n#> Call:\n#> lm(formula = PS ~ ., data = conj_treino)\n#> \n#> Residuals:\n#>      Min       1Q   Median       3Q      Max \n#> -0.78334 -0.06849  0.09515  0.19505  0.47278 \n#> \n#> Coefficients:\n#>               Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept) -14.704848   4.004145  -3.672  0.00794 ** \n#> Idade         0.756631   0.067774  11.164 1.03e-05 ***\n#> Peso          1.014897   0.104982   9.667 2.67e-05 ***\n#> Acorp         2.426007   2.723376   0.891  0.40261    \n#> Dur           0.036057   0.067581   0.534  0.61018    \n#> Pulso        -0.115978   0.070242  -1.651  0.14270    \n#> Stress        0.006775   0.004722   1.435  0.19450    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 0.4551 on 7 degrees of freedom\n#> Multiple R-squared:  0.9961,\tAdjusted R-squared:  0.9927 \n#> F-statistic: 295.3 on 6 and 7 DF,  p-value: 4.705e-08\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Carregando pacotes exigidos: carData\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> \n#> Anexando pacote: 'car'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> O seguinte objeto é mascarado por 'package:psych':\n#> \n#>     logit\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> O seguinte objeto é mascarado por 'package:dplyr':\n#> \n#>     recode\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> O seguinte objeto é mascarado por 'package:purrr':\n#> \n#>     some\n```\n\n\n:::\n\n```{.r .cell-code}\nvif(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>     Idade      Peso     Acorp       Dur     Pulso    Stress \n#>  1.839128 11.506832  8.452385  1.255999  4.764421  1.798917\n```\n\n\n:::\n:::\n\n\n## 2a. Avaliação\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod2 <- update(mod1,. ~ . -Acorp) \nsummary(mod2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> \n#> Call:\n#> lm(formula = PS ~ Idade + Peso + Dur + Pulso + Stress, data = conj_treino)\n#> \n#> Residuals:\n#>      Min       1Q   Median       3Q      Max \n#> -0.78828 -0.09161  0.03481  0.28998  0.42216 \n#> \n#> Coefficients:\n#>               Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept) -16.636422   3.322506  -5.007  0.00104 ** \n#> Idade         0.779649   0.061841  12.607 1.47e-06 ***\n#> Peso          1.099617   0.043878  25.061 6.88e-09 ***\n#> Dur           0.028417   0.066164   0.429  0.67890    \n#> Pulso        -0.148601   0.059162  -2.512  0.03627 *  \n#> Stress        0.007890   0.004494   1.756  0.11724    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 0.4492 on 8 degrees of freedom\n#> Multiple R-squared:  0.9956,\tAdjusted R-squared:  0.9929 \n#> F-statistic: 363.5 on 5 and 8 DF,  p-value: 3.31e-09\n```\n\n\n:::\n\n```{.r .cell-code}\nvif(mod2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>    Idade     Peso      Dur    Pulso   Stress \n#> 1.571811 2.063392 1.235775 3.469415 1.672564\n```\n\n\n:::\n:::\n\n\n## 3a. Avaliação\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod3 <- lm(PS ~ Idade + Peso + Pulso + Stress, data = conj_treino)\nsummary(mod3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> \n#> Call:\n#> lm(formula = PS ~ Idade + Peso + Pulso + Stress, data = conj_treino)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -0.7491 -0.1267  0.0447  0.2459  0.4706 \n#> \n#> Coefficients:\n#>               Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept) -16.572609   3.165229  -5.236 0.000538 ***\n#> Idade         0.783241   0.058431  13.405 2.98e-07 ***\n#> Peso          1.094261   0.040118  27.276 5.80e-10 ***\n#> Pulso        -0.142220   0.054610  -2.604 0.028537 *  \n#> Stress        0.008011   0.004277   1.873 0.093850 .  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 0.4284 on 9 degrees of freedom\n#> Multiple R-squared:  0.9955,\tAdjusted R-squared:  0.9935 \n#> F-statistic: 499.6 on 4 and 9 DF,  p-value: 1.482e-10\n```\n\n\n:::\n\n```{.r .cell-code}\nresidualPlots(mod3)\n```\n\n::: {.cell-output-display}\n![](Aula07.2B_files/figure-html/unnamed-chunk-10-1.png){width=90%}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>            Test stat Pr(>|Test stat|)\n#> Idade        -0.3779           0.7153\n#> Peso         -0.8326           0.4292\n#> Pulso         0.5699           0.5844\n#> Stress       -0.7313           0.4855\n#> Tukey test   -0.9748           0.3296\n```\n\n\n:::\n:::\n\n\n## Comparando Previsão vs Real\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconj_treino$Previsoes <- predict(mod3, data=conj_treino)\nggplot(conj_treino, aes(x=Previsoes, y=PS)) + \n  geom_point() +\n  geom_abline(color = \"darkblue\") +\n  ggtitle(\"Pressão sanguinea vs. Previsões do modelo linear\")\n```\n\n::: {.cell-output-display}\n![](Aula07.2B_files/figure-html/unnamed-chunk-11-1.png){width=90%}\n:::\n:::\n\n\n## Teste dos resíduos\n\nTeste de normalidade Teste de heterocedasticidade (Bresch-Pagan) Teste de autocorrelação (Durbin-Watson)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lmtest)\nmod3_sum <- summary(mod3)\n# Teste de normalidade\nshapiro.test(mod3_sum$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> \n#> \tShapiro-Wilk normality test\n#> \n#> data:  mod3_sum$residuals\n#> W = 0.93949, p-value = 0.4118\n```\n\n\n:::\n\n```{.r .cell-code}\n# Teste de hetrocedasticidade\nbptest(mod3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> \n#> \tstudentized Breusch-Pagan test\n#> \n#> data:  mod3\n#> BP = 1.4231, df = 4, p-value = 0.8402\n```\n\n\n:::\n\n```{.r .cell-code}\n# Teste de autocorrelação\ndwtest(mod3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> \n#> \tDurbin-Watson test\n#> \n#> data:  mod3\n#> DW = 1.7244, p-value = 0.3101\n#> alternative hypothesis: true autocorrelation is greater than 0\n```\n\n\n:::\n:::\n\n\n## Avaliação com conjunto de teste\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsqrt(mean((conj_teste$PS - predict(mod3, conj_teste)) ^ 2)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> [1] 0.5975429\n```\n\n\n:::\n:::\n\n",
    "supporting": [
      "Aula07.2B_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}