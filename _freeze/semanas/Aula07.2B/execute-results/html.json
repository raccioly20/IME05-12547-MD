{
  "hash": "e625f7aade3ccb5ec7a8f9ffbde3b57f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Problemas na Regressão Multipla\"\nauthor: \"Ricardo Accioly\"\ndate: \"2024-03-28\"\nformat:\n  html:\n    grid: \n      margin-width: 350px\n    code-link: TRUE\nreference-location: margin\ncitation-location: margin\n---\n\n\n## Carregando bibliotecas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(caret)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCarregando pacotes exigidos: lattice\n\nAttaching package: 'caret'\n\nThe following object is masked from 'package:purrr':\n\n    lift\n```\n\n\n:::\n:::\n\n\n## Dados de pressão sanguinea\n\n-   BP = Pressão sanguínea (em mm Hg)\n\n-   Age = idade (em anos)\n\n-   Weight = peso (em kg)\n\n-   BSA = area superficial do corpo (em m2)\n\n-   Dur = duração da hipertensão (em anos)\n\n-   Pulse = batimentos (batidas por minuto)\n\n-   Stress = índice de stress\n\n\n::: {.cell}\n\n```{.r .cell-code}\npressao_sangue <- read_delim(\"bloodpress.txt\", col_names = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 20 Columns: 8\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \"\\t\"\ndbl (8): Pt, BP, Age, Weight, BSA, Dur, Pulse, Stress\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n## Renomeando\n\n\n::: {.cell}\n\n```{.r .cell-code}\npressao_sangue <- pressao_sangue %>% rename(PS = BP, Idade = Age,\n                                            Peso = Weight, Acorp = BSA,\n                                            Pulso = Pulse)\n```\n:::\n\n\n## Sumario\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(pressao_sangue)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Pt              PS            Idade            Peso       \n Min.   : 1.00   Min.   :105.0   Min.   :45.00   Min.   : 85.40  \n 1st Qu.: 5.75   1st Qu.:110.0   1st Qu.:47.00   1st Qu.: 90.22  \n Median :10.50   Median :114.0   Median :48.50   Median : 94.15  \n Mean   :10.50   Mean   :114.0   Mean   :48.60   Mean   : 93.09  \n 3rd Qu.:15.25   3rd Qu.:116.2   3rd Qu.:49.25   3rd Qu.: 94.85  \n Max.   :20.00   Max.   :125.0   Max.   :56.00   Max.   :101.30  \n     Acorp            Dur            Pulso           Stress     \n Min.   :1.750   Min.   : 2.50   Min.   :62.00   Min.   : 8.00  \n 1st Qu.:1.897   1st Qu.: 5.25   1st Qu.:67.75   1st Qu.:17.00  \n Median :1.980   Median : 6.00   Median :70.00   Median :44.50  \n Mean   :1.998   Mean   : 6.43   Mean   :69.60   Mean   :53.35  \n 3rd Qu.:2.075   3rd Qu.: 7.60   3rd Qu.:72.00   3rd Qu.:95.00  \n Max.   :2.250   Max.   :10.20   Max.   :76.00   Max.   :99.00  \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncor(pressao_sangue[,-1])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              PS     Idade       Peso      Acorp       Dur     Pulso     Stress\nPS     1.0000000 0.6590930 0.95006765 0.86587887 0.2928336 0.7214132 0.16390139\nIdade  0.6590930 1.0000000 0.40734926 0.37845460 0.3437921 0.6187643 0.36822369\nPeso   0.9500677 0.4073493 1.00000000 0.87530481 0.2006496 0.6593399 0.03435475\nAcorp  0.8658789 0.3784546 0.87530481 1.00000000 0.1305400 0.4648188 0.01844634\nDur    0.2928336 0.3437921 0.20064959 0.13054001 1.0000000 0.4015144 0.31163982\nPulso  0.7214132 0.6187643 0.65933987 0.46481881 0.4015144 1.0000000 0.50631008\nStress 0.1639014 0.3682237 0.03435475 0.01844634 0.3116398 0.5063101 1.00000000\n```\n\n\n:::\n:::\n\n\nAqui vemos que a presssão sanguinea tem uma correlação forte com o peso e também com a área corporal. O peso e a area corporal tem uma correlação forte. Esta correlação alta pode indicar a existencia de multicolinearidade.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(psych)\npairs.panels(pressao_sangue[,-1])\n```\n\n::: {.cell-output-display}\n![](Aula07.2B_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndados <- pressao_sangue[,-1]\nmod1 <- lm(PS ~ ., data=dados)\nsummary(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = PS ~ ., data = dados)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.93213 -0.11314  0.03064  0.21834  0.48454 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -12.870476   2.556650  -5.034 0.000229 ***\nIdade         0.703259   0.049606  14.177 2.76e-09 ***\nPeso          0.969920   0.063108  15.369 1.02e-09 ***\nAcorp         3.776491   1.580151   2.390 0.032694 *  \nDur           0.068383   0.048441   1.412 0.181534    \nPulso        -0.084485   0.051609  -1.637 0.125594    \nStress        0.005572   0.003412   1.633 0.126491    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4072 on 13 degrees of freedom\nMultiple R-squared:  0.9962,\tAdjusted R-squared:  0.9944 \nF-statistic: 560.6 on 6 and 13 DF,  p-value: 6.395e-15\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(car)\nvif(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Idade     Peso    Acorp      Dur    Pulso   Stress \n1.762807 8.417035 5.328751 1.237309 4.413575 1.834845 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod2 <- update(mod1,. ~ . -Acorp) \nsummary(mod2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = PS ~ Idade + Peso + Dur + Pulso + Stress, data = dados)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.02600 -0.18526 -0.00077  0.21934  0.72533 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -15.116781   2.748758  -5.499 7.83e-05 ***\nIdade         0.731940   0.055646  13.154 2.85e-09 ***\nPeso          1.098958   0.037773  29.093 6.37e-14 ***\nDur           0.064105   0.055965   1.145   0.2712    \nPulso        -0.137444   0.053885  -2.551   0.0231 *  \nStress        0.007429   0.003841   1.934   0.0736 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4708 on 14 degrees of freedom\nMultiple R-squared:  0.9945,\tAdjusted R-squared:  0.9925 \nF-statistic: 502.5 on 5 and 14 DF,  p-value: 2.835e-15\n```\n\n\n:::\n\n```{.r .cell-code}\nvif(mod2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Idade     Peso      Dur    Pulso   Stress \n1.659637 2.256150 1.235620 3.599913 1.739641 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod3 <- lm(PS ~ Idade + Peso + Pulso + Stress, data = dados)\nsummary(mod3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = PS ~ Idade + Peso + Pulso + Stress, data = dados)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.89479 -0.15857 -0.04157  0.25593  0.92857 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -15.683749   2.731808  -5.741 3.90e-05 ***\nIdade         0.739878   0.055784  13.263 1.09e-09 ***\nPeso          1.097262   0.038135  28.773 1.54e-14 ***\nPulso        -0.126973   0.053654  -2.367   0.0318 *  \nStress        0.007851   0.003863   2.032   0.0602 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4757 on 15 degrees of freedom\nMultiple R-squared:  0.9939,\tAdjusted R-squared:  0.9923 \nF-statistic:   615 on 4 and 15 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nresidualPlots(mod3)\n```\n\n::: {.cell-output-display}\n![](Aula07.2B_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           Test stat Pr(>|Test stat|)\nIdade         0.3403           0.7387\nPeso          0.3825           0.7078\nPulso         0.0914           0.9285\nStress       -0.5581           0.5856\nTukey test    0.2340           0.8150\n```\n\n\n:::\n:::\n\n\n## Teste dos resíduos\n\nTeste de normalidade Teste de heterocedasticidade (Bresch-Pagan) Teste de autocorrelação (Durbin-Watson)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lmtest)\nmod3_sum <- summary(mod3)\n# Teste de normalidade\nshapiro.test(mod3_sum$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  mod3_sum$residuals\nW = 0.95962, p-value = 0.5364\n```\n\n\n:::\n\n```{.r .cell-code}\n# Teste de hetrocedasticidade\nbptest(mod3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tstudentized Breusch-Pagan test\n\ndata:  mod3\nBP = 1.9471, df = 4, p-value = 0.7455\n```\n\n\n:::\n\n```{.r .cell-code}\n# Teste de autocorrelação\ndwtest(mod3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tDurbin-Watson test\n\ndata:  mod3\nDW = 1.6389, p-value = 0.2115\nalternative hypothesis: true autocorrelation is greater than 0\n```\n\n\n:::\n:::\n",
    "supporting": [
      "Aula07.2B_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}